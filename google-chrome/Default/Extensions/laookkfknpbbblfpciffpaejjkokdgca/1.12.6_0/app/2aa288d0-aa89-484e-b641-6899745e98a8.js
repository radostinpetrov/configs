var fn_addin=function(t,i,e){var a=a||{};return a.styles=a.styles||{},a.commands=a.commands||{},a.dependencies=e||a.dependencies||{},a.styles.style=function(){},a.views=a.views||{},a.collect=a.collect||{},a.models=a.models||{},a.templates=a.templates||{},a.info={widget:!0,placeholderType:"metric",id:"metric",class:"generic-stats metric app-container app-dash add-shadow",region:"top-right",order:"append",addin:"2aa288d0-aa89-484e-b641-6899745e98a8",requiredFeature:"randomWidget"},t.console.log(t.elapsed()+": "+a.info.id+" started"),a.templates=a.templates||{},a.templates.widget=Handlebars.template({compiler:[6,">= 2.0.0-beta.1"],main:function(e,t,i,a){var n,s=t.helperMissing,l="function",r=this.escapeExpression;return'<span class="metric-stat">'+r(typeof(n=null!=(n=t.statvalue||(null!=e?e.statvalue:e))?n:s)==l?n.call(e,{name:"statvalue",hash:{},data:a}):n)+'</span><span class="metric-label">'+r(typeof(n=null!=(n=t.statlabel||(null!=e?e.statlabel:e))?n:s)==l?n.call(e,{name:"statlabel",hash:{},data:a}):n)+"</span>"},useData:!0}),a.models.GenericMetric=Backbone.Model.extend({defaults:{id:null,label:"",value:"",link:null},initialize:function(){this.listenTo(this,"change:metric",this.metricChanged),this.loadData()},loadData:function(){var c=this;this.set("label","");var e=t.globals.urlRootIntegration+"services/random";try{i.ajax({type:"GET",contentType:"application/json",beforeSend:t.utils.setMomentumAuthHeader,url:e}).done(function(e,t,i){if(e.metricInfo)c.set("id",e.metricInfo.metricId),c.set("value",e.metricInfo.metricValue),c.set("label",e.metricInfo.metricLabel),e.metricInfo.metricLink?c.set("link",e.metricInfo.metricLink):c.set("link",null);else if(e.status&&"authRequired"==e.status&&e.authorizationUrl&&c.authAttempts<2){c.authAttempts++;var a=e.winWidth?e.winWidth:600,n=e.winHeight?e.winHeight:510,s=e.windowFeatures?e.windowFeatures:"titlebar,resizable,toolbar,status",l=window.screen.width/2-a/2,r=window.screen.height/2-n/2,o=window.open(e.authorizationUrl,"MomentumAuthWindow",s+",left="+l+",top="+r+",width="+a+",height="+n),d=setInterval(function(){o.closed&&(clearInterval(d),c.metricChanged())},250)}}).fail(function(e,t){console.log("failed")})}catch(e){}},clickMetric:function(){this.get("link")}}),a.views.GenericMetric=Backbone.View.extend({template:a.templates.widget,events:{click:"clickMetric",mouseenter:"mouseEnter",mouseleave:"mouseLeave"},initialize:function(){this.renderedOnce=!1,this.render(),this.listenTo(this.model,"change:value",this.render),this.listenTo(this.model,"change:label",this.render)},render:function(){var e=this.model.get("label"),t=this.model.get("value");if(t){this.$el.addClass("metric-item");var i={statvalue:t,statlabel:e};if(this.renderedOnce)this.$el.html(this.template(i)),this.$time=this.$(".time"),this.$format=this.$(".format");else{var a=(this.options.order||"append")+"To";this.$el[a]("."+this.options.region).mFadeIn().html(this.template(i)),this.$time=this.$(".time"),this.$format=this.$(".format"),this.renderedOnce=!0}this.triggerLoaded()}else this.triggerLoaded()},triggerLoaded:function(e){this.loadTriggered||(t.widgetManager.appReady(a.info.id),this.loadTriggered=!0)},clickMetric:function(e){this.model.clickMetric()}}),a.styles.style(),a.models.genericMetric=new a.models.GenericMetric,a.views.countdown=t.widgetManager.handover("metric",a.views.GenericMetric,{model:a.models.genericMetric,region:"top-right",order:"append"}),a};m.addinManager&&m.addinManager.registerAddinFn("2aa288d0-aa89-484e-b641-6899745e98a8",fn_addin);