ZY.prototype.iH=W(1412,m(10));pZ.prototype.iH=W(1411,g("Oa"));sZ.prototype.iH=W(1410,g("D"));VGe.prototype.iH=W(1409,m(10));function U6e(a,b,c){var d=Ki(a.C,RX,1),e=new RX;M(e,1,b);M(e,2,c);M(e,4,0);M(e,3,Ga());d.push(e);ed(d,function(f,h){return(h.Wh()||0)-(f.Wh()||0)});ad(d,void 0,function(f){return L(f,1)+", "+f.tb()});Ni(a.C,1,$c(d,0,a.R));rud(a)}function V6e(a){return a.D["ritz-DataPrepSuggestionsSidepaneCount"]}
function W6e(a){var b=a.sf,c=a.eca,d=a.hca,e=a.fca,f=a.cca;a='<div class="'+T("waffle-assistant-popup-suggestion-text")+'">';b='Data cleanup suggestions available for <span class="'+(T("waffle-inline-assistant-rec-range")+'">'+(R(b)+"</span>"));a=a+b+"<ul>";0<f&&(a+="<li>",b=CV(new Wz("{NUM_ANOMALIES_1,plural,=1{{START_BOLD}{NUM_ANOMALIES_2}{END_BOLD} anomaly}other{{START_BOLD}{NUM_ANOMALIES_2}{END_BOLD} anomalies}}"),{NUM_ANOMALIES_1:f,START_BOLD:"<b>",NUM_ANOMALIES_2:R(f),END_BOLD:"</b>"}),a=a+
b+"</li>");0<e&&(a+="<li>",e=CV(new Wz("{NUM_REMOVE_DUPLICATE_SUGGESTIONS_1,plural,=1{{START_BOLD}{NUM_REMOVE_DUPLICATE_SUGGESTIONS_2}{END_BOLD} duplicate row}other{{START_BOLD}{NUM_REMOVE_DUPLICATE_SUGGESTIONS_2}{END_BOLD} duplicate rows}}"),{NUM_REMOVE_DUPLICATE_SUGGESTIONS_1:e,START_BOLD:"<b>",NUM_REMOVE_DUPLICATE_SUGGESTIONS_2:R(e),END_BOLD:"</b>"}),a+=e,a+="</li>");0<c&&(a+="<li>",c=CV(new Wz("{NUM_NF_SUGGESTIONS_1,plural,=1{{START_BOLD}{NUM_NF_SUGGESTIONS_2}{END_BOLD} column format suggestion}other{{START_BOLD}{NUM_NF_SUGGESTIONS_2}{END_BOLD} column format suggestions}}"),
{NUM_NF_SUGGESTIONS_1:c,START_BOLD:"<b>",NUM_NF_SUGGESTIONS_2:R(c),END_BOLD:"</b>"}),a+=c,a+="</li>");0<d&&(a+="<li>",d=CV(new Wz("{NUM_TRIM_WS_SUGGESTIONS_1,plural,=1{{START_BOLD}{NUM_TRIM_WS_SUGGESTIONS_2}{END_BOLD} range with excess whitespace}other{{START_BOLD}{NUM_TRIM_WS_SUGGESTIONS_2}{END_BOLD} ranges with excess whitespace}}"),{NUM_TRIM_WS_SUGGESTIONS_1:d,START_BOLD:"<b>",NUM_TRIM_WS_SUGGESTIONS_2:R(d),END_BOLD:"</b>"}),a+=d,a+="</li>");a+="</ul></div>";return S(a)}
function X6e(a){var b=a.sf,c=a.AOa;a='<div class="'+T("waffle-assistant-popup-suggestion-text")+'">';b=R(c)+(' data cleanup suggestions available for <span class="'+(T("waffle-inline-assistant-rec-range")+'">'+(R(b)+"</span>")));return S(a+b+"</div>")}
function Y6e(a,b,c){b=c||b;c=a.sf;var d=a.eca,e=a.hca,f=a.fca,h=a.cca;a=a.WZb;var k='<div class="'+T("waffle-assistant-floating-popup")+'"><div class="'+T("waffle-assistant-popup-logo")+'" aria-label="';k+=hw("Data cleanup suggestions");k+='">'+R(uA({icon:"docs-icon-img docs-icon-explore-green"},b))+'</div><div class="'+T("waffle-assistant-popup-suggestion-text-container")+'">'+(a?W6e({sf:c,eca:d,hca:e,fca:f,cca:h},b):X6e({sf:c,AOa:d+e+f+h},b))+'</div><div class="'+T("waffle-assistant-popup-button-row")+
'">';k+=R(pz({hd:"waffle-assistant-popup-button waffle-assistant-popup-button-dismiss",content:"Dismiss",id:"waffle-assistant-popup-button-dismiss",style:0},b));k+=R(pz({hd:"waffle-assistant-popup-button waffle-assistant-popup-button-review",content:"Review",id:"waffle-assistant-popup-button-review",style:2},b));return S(k+"</div></div>")}
function Z6e(a,b){a.D=0;a.F=0;a.C=0;b=ja(b);for(var c=b.next();!c.done;c=b.next())switch(c=c.value,E(c,1)){case 7:a.D++;break;case 8:a.F++;break;case 9:c=E(c,16),c=Of(c,5),a.C+=c.length}}function $6e(a){var b=new lj;for(d in EXb){var c=new mde;switch(EXb[d]){case 7:M(c,1,1);M(c,2,a.D);break;case 8:M(c,1,2);M(c,2,a.F);break;case 9:M(c,1,4);M(c,2,a.C);break;default:continue}Oi(b,25,c,mde,void 0)}var d=new mde;M(d,1,3);M(d,2,a.H);Oi(b,25,d,mde,void 0);return ey(ay(new $x,76),b).build()}
function a7e(a,b,c,d,e,f){Q.call(this,f);var h=this;this.ea=a;this.J=c;this.C=this.F=this.D=-1;Z6e(this,d);this.H=e;this.L=(new nP).build();this.va(this.L);this.R=new iy(void 0,gy.getInstance(),this.qa());this.Ga(this.R);lz(this.L,this.R,jmb,void 0,void 0,function(){return $6e(h)});this.O=new iy(void 0,gy.getInstance(),this.qa());this.Ga(this.O);lz(this.L,this.O,imb,void 0,void 0,function(){return $6e(h)});this.V=new rY(b,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");
this.va(this.V)}u(a7e,Q);p=a7e.prototype;p.Ba=function(){var a=TN(this.J.rect);a=vx(Y6e,{sf:a,eca:this.D,hca:this.F,fca:this.C,cca:this.H,WZb:A(z(),"feadpdp")});this.ib(a)};p.Ha=function(){Q.prototype.Ha.call(this);this.R.Wa(this.Ea("waffle-assistant-popup-button-review"));this.O.Wa(this.Ea("waffle-assistant-popup-button-dismiss"));var a=this.Ka();this.getHandler().listen(a,"mouseenter",this.oRb).listen(a,"mouseleave",this.pRb);a={};hv(this.ea,(a.Cc=!0,a));HK("Assistant suggestion popup shown.")};
p.Ja=function(){Q.prototype.Ja.call(this);var a={};hv(this.ea,(a.Cc=!1,a));HK("Assistant suggestion popup hidden.")};p.oRb=function(){tY(this.V,this.J)};p.pRb=function(){qY(this.V)};function b7e(a,b,c,d,e,f){if(a.Yb&&!a.Yb.isDisposed())return a.Yb;var h=Rn(a.qa(),a.La.tb()+"-grid-table-container");a.Yb=new a7e(c,b,d,e,f,a.cb);a.Ga(a.Yb);a.Yb.render(h);return a.Yb}
function c7e(a){var b=a.hSb,c=a.kSb,d=a.gSb,e=a.sf,f=a.bSb;a='<div tabindex=0 class="'+T("waffle-assistant-popup-suggestion")+'"><div class="'+T("waffle-assistant-card-checkbox")+'"></div><div class="'+T("waffle-assistant-card-text")+'">';dw(c,b)?(b='Change <span class="'+(T("waffle-inline-assistant-rec-range")+'">'+(R(e)+('</span> to use <span class="'+(T("waffle-inline-assistant-rec-detail")+'">'+(R(b)+(" ("+(R(d)+")</span> format?"))))))),a+=b):dw(c,"UNKNOWN")?(b='Change <span class="'+(T("waffle-inline-assistant-rec-range")+
'">'+(R(e)+('</span> to use <span class="'+(T("waffle-inline-assistant-rec-detail")+'">'+(R(b)+"</span> format?"))))),a+=b):(b='Change <span class="'+(T("waffle-inline-assistant-rec-range")+'">'+(R(e)+('</span> (now <span class="'+(T("waffle-inline-assistant-rec-detail")+'">'+(R(c)+('</span>) to use <span class="'+(T("waffle-inline-assistant-rec-detail")+'">'+(R(b)+"</span> format?")))))))),a+=b);1<f&&(f=' (<span class="'+(T("waffle-assistant-popup-num-patterns")+'">'+(R(f)+"</span> different number formats detected.)")),
a+=f);return S(a+"</div></div>")}function d7e(a){var b=a.column,c=a.Cha;a='<div tabindex=0 class="'+T("waffle-assistant-popup-suggestion")+'"><div class="'+T("waffle-assistant-card-checkbox")+'"></div><div class="'+T("waffle-assistant-card-text")+'">';b='Apply <span class="'+(T("waffle-inline-assistant-rec-detail")+'">'+(R(c)+('</span> type to column <span class="'+(T("waffle-inline-assistant-rec-range")+'">'+(R(b)+"</span>?")))));return S(a+b+"</div></div>")}
function e7e(a){var b=a.fSb,c=a.sf,d=a.Y_a,e=a.gCb,f=a.YRb;a='<div tabindex=0 class="'+T("waffle-assistant-popup-suggestion")+'"><div class="'+T("waffle-assistant-card-checkbox")+'"></div><div class="'+T("waffle-assistant-card-text")+'">';d?e?(b='Change <span class="'+(T("waffle-inline-assistant-rec-range")+'">'+(R(c)+('</span> to trim <span class="'+(T("waffle-inline-assistant-rec-detail")+'">'+(R(b)+(' trailing</span> spaces across <span class="'+(T("waffle-inline-assistant-rec-detail")+'">'+(R(f)+
"</span> cells?")))))))),a+=b):(b=CV(new Wz("{NUM_WHITESPACES_1,plural,=1{Change {START_SPAN_1}{RANGE}{END_SPAN} to trim {START_SPAN_2}{NUM_WHITESPACES_2} trailing{END_SPAN} space?}other{Change {START_SPAN_3}{RANGE}{END_SPAN} to trim {START_SPAN_4}{NUM_WHITESPACES_2} trailing{END_SPAN} spaces?}}"),{NUM_WHITESPACES_1:b,START_SPAN_1:'<span class="'+T("waffle-inline-assistant-rec-range")+'">',RANGE:R(c),END_SPAN:"</span>",START_SPAN_2:'<span class="'+T("waffle-inline-assistant-rec-detail")+'">',NUM_WHITESPACES_2:R(b),
START_SPAN_3:'<span class="'+T("waffle-inline-assistant-rec-range")+'">',START_SPAN_4:'<span class="'+T("waffle-inline-assistant-rec-detail")+'">'}),a+=b):e?(b='Change <span class="'+(T("waffle-inline-assistant-rec-range")+'">'+(R(c)+('</span> to trim <span class="'+(T("waffle-inline-assistant-rec-detail")+'">'+(R(b)+('</span> spaces across <span class="'+(T("waffle-inline-assistant-rec-detail")+'">'+(R(f)+"</span> cells?")))))))),a+=b):(b=CV(new Wz("{NUM_WHITESPACES_1,plural,=1{Change {START_SPAN_1}{RANGE}{END_SPAN} to trim {START_SPAN_2}{NUM_WHITESPACES_2}{END_SPAN} space?}other{Change {START_SPAN_3}{RANGE}{END_SPAN} to trim {START_SPAN_4}{NUM_WHITESPACES_2}{END_SPAN} spaces?}}"),
{NUM_WHITESPACES_1:b,START_SPAN_1:'<span class="'+T("waffle-inline-assistant-rec-range")+'">',RANGE:R(c),END_SPAN:"</span>",START_SPAN_2:'<span class="'+T("waffle-inline-assistant-rec-detail")+'">',NUM_WHITESPACES_2:R(b),START_SPAN_3:'<span class="'+T("waffle-inline-assistant-rec-range")+'">',START_SPAN_4:'<span class="'+T("waffle-inline-assistant-rec-detail")+'">'}),a+=b);return S(a+"</div></div>")}
function f7e(a){var b=a.sf,c=a.Cha;a='<div tabindex=0 class="'+T("waffle-assistant-popup-suggestion")+'"><div class="'+T("waffle-assistant-card-checkbox")+" "+T("waffle-assistant-card-checkbox-disabled")+'"></div><div class="'+T("waffle-assistant-card-text")+'">';b='Cell <span class="'+(T("waffle-inline-assistant-rec-range")+'">'+(R(b)+('</span> might not match detected type <span class="'+(T("waffle-inline-assistant-rec-detail")+'">'+(R(c)+"</span>.")))));a=a+b+('</div><div class="'+T("waffle-assistant-form")+
'">');a+='<input type="text" class="'+T("jfk-textinput")+'" placeholder="'+T("Input to fix anomaly")+'" aria-label="'+T("Input to fix anomaly")+'"/></div></div>';return S(a)}function g7e(a){var b='<div class="waffle-inline-assistant-sidebar-survey-container">';a='<a href="'+T(iw(a.link))+'" class="'+T("waffle-inline-assistant-sidebar-survey-link")+'" target="_blank">Take a brief survey to let us know how we\'re doing!</a>';return S(b+a+"</div>")}
function h7e(){return S('<div class="waffle-inline-assistant-sidebar-intro">See these suggestions also by using the toolbar menu Data -> Cleanup suggestions.<br><br>Tip: hover over suggestions to preview changes on the sheet</div>')}
function i7e(a){za(a.iRa);var b=a.iRa;za(a.hRa);var c=a.hRa;a='<div tabindex=0 class="'+T("waffle-assistant-popup-suggestion")+'"><div class="'+T("waffle-assistant-card-checkbox")+'"></div><div class="'+T("waffle-assistant-card-text")+'">';var d=""+(b[0]+1),e=""+(c[c.length-1]+1);if(1<b.length)d='<span class="'+T("waffle-inline-assistant-rec-range")+'">'+(R(b.length)+('</span> rows in the table have <span class="'+(T("waffle-inline-assistant-rec-range-red")+'">duplicates</span>. Remove duplicate rows?'))),
a+=d;else if(1==c.length)d='Row <span class="'+(T("waffle-inline-assistant-rec-range")+'">'+(R(d)+('</span> has a duplicate at row <span class="'+(T("waffle-inline-assistant-rec-range-red")+'">'+(R(e)+"</span>. Remove duplicate row?"))))),a+=d;else if(1<c.length&&6>=c.length){b=""+(c[0]+1);for(var f=Math.max(0,Math.ceil(c.length-1-1)),h=0;h<f;h++)b+=", "+(c[1+h]+1);d='Row <span class="'+(T("waffle-inline-assistant-rec-range")+'">'+(R(d)+('</span> has duplicates at rows <span class="'+(T("waffle-inline-assistant-rec-range-red")+
'">'+(R(b)+('</span> and <span class="'+(T("waffle-inline-assistant-rec-range-red")+'">'+(R(e)+"</span>. Remove duplicate rows?"))))))));a+=d}else{e=""+(c[0]+1);for(b=0;2>b;b++)e+=", "+(c[1+b]+1);c=""+(c.length-4);d='Row <span class="'+(T("waffle-inline-assistant-rec-range")+'">'+(R(d)+('</span> has duplicates at rows <span class="'+(T("waffle-inline-assistant-rec-range-red")+'">'+(R(e)+('</span> and <span class="'+(T("waffle-inline-assistant-rec-range-red")+'">'+(R(c)+"</span> others. Remove duplicate rows?"))))))));
a+=d}return S(a+"</div></div>")}function j7e(a,b,c){var d=a.Wc(),e=a.Vc();switch(b){case 0:d=Math.min(d,a.rc()+c);break;case 1:e=Math.min(e,a.mc()+c)}return nm(a.tb(),a.rc(),a.mc(),d,e)}
function k7e(){return S('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-answercard-content"><div class="waffle-assistant-answercard-interpret-content"><div class="waffle-assistant-answercard-interpret"></div></div><div class="waffle-assistant-answercard-answer-content"><div class="waffle-assistant-answercard-pivot-content"></div></div></div></div>')}
function l7e(a,b,c){b=c||b;return S(R(pz({hd:"waffle-assistant-insert-pivottable-button waffle-assistant-readonly-hidden",content:fw(""+R(uA({icon:"docs-icon-img docs-icon-insert-pivot-table"},b))),style:4},b))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+R(pz({hd:"waffle-assistant-zoom-button",content:fw(""+R(uA({icon:"docs-icon-img docs-icon-zoom-in"},b))),style:4},b)))}
function m7e(a,b,c,d,e,f,h){IZ.call(this,a,b,c,new HFe,"regular",e,f,h);this.Oa=d;a=a.C;c=new lQ(c,!0,!0);this.R=new XGe(a,new xDe(c),b);this.R.Fa=this.C;b=new wK;F(b,5,!0);F(b,12,Fjb);this.Pa=new MHe(b);this.H=this.ea=null;this.V=[]}u(m7e,IZ);p=m7e.prototype;p.Ha=function(){IZ.prototype.Ha.call(this);this.getHandler().listen(this.Oa,"selectionChange",this.LHb)};p.hMa=function(a){this.R.L=a;this.O.zB(a)};p.E$=function(){IZ.prototype.E$.call(this);n7e(this)};
p.OC=function(){var a=this.J;return qJ(a.C)?xte(a)?IZ.prototype.OC.call(this):!1:!1};p.lFa=function(){cAe(null,this.V,null,this.C)};p.vIa=function(a){cAe(a,this.V,null,this.C)};p.LHb=function(){o7e(this)&&n7e(this)};p.G_=function(){var a=IZ.prototype.G_.call(this);a&&(this.H=null,o7e(this)&&n7e(this));return a};function o7e(a){a=a.J;return qJ(a.C)&&fO(a)}
function n7e(a){if(a.OC()){var b=a.J.C,c=tJ(b),d=gad(c);if(0<d.length)b=EV(d[0].getTableRange()),a.H&&b.equals(EV(a.H.getTableRange()))||(a.H=d[0],a.G3());else if(null!=a.H){d=EV(a.H.getTableRange());b=d.tb()!=mJ(b);var e=!1;if(!b){var f=kK(c);c=ritz_api.TablesApi.getCurrentlyDetectedTables(sm(qm(f,c.$b())));c=ja(c);for(f=c.next();!f.done;f=c.next())if(wm(EV(f.value.getTableRange()),d)){e=!0;break}}if(b||!e)a.H=null,a.G3()}}else a.yB()}
p.G3=function(){var a=this;this.yB();if(this.H){var b=EV(this.H.getTableRange()),c=[tm(b)];null!=this.ea&&this.ea.cancel();5E4<Dwa(b)||(this.ea=NHe(this.Pa,c),ko(this.ea.then(function(d){a.Db()&&p7e(a,d.C)}),function(){a.yB()}))}};
function p7e(a,b){a.V=b;var c=null;b=ja(b);for(var d=b.next();!d.done;d=b.next())d=d.value,3==Pf(d,1)&&(c=d);if(c&&.6<E(c,2)){b=E(c,9)||new rK;var e=Ic(Of(b,1),function(l){return l.getName()}),f=[],h=[];d=ja(Of(b,2));for(var k=d.next();!k.done;k=d.next())k=k.value,f.push(k.getName()),h=h.concat(Of(k,2));d=tm(eY(c));k=Kf(c,11)?E(c,11):null;c=null==k?null:tm(E(c,10));a.R.init(b,d,c,k,[],[]);a.R.oU();a.R.p1().then(function(l){KHe(a,e,f,h,l)})}dAe(a.V,null,a.C)}
p.yB=function(){IZ.prototype.yB.call(this);this.V=[];this.R.reset();dAe(null,null,this.C)};function q7e(a,b){kV.call(this,void 0,b,!1,!0);this.H=a;this.setTitle("Additional info");this.C.setVisible(!1)}u(q7e,kV);q7e.prototype.Ba=function(){var a=this;kV.prototype.Ba.call(this);Aw(this.Ka(),"waffle-assistant-feedback-product-info-dialog");var b=Object.keys(this.H).map(function(c){var d=a.H[c];return oe("DIV",void 0,[oe("DT",void 0,c+":"),oe("DD",void 0,String(d))])});Pw(this,qe(b))};
q7e.prototype.Ha=function(){kV.prototype.Ha.call(this);var a=Rw(this);if(a){var b=vw(a);Ey(a,b,void 0)}};function r7e(a){var b=a.GO,c=a.index,d=a.checked;return S(R(QU({hd:"waffle-assistant-feedback-dialog-radio-button",name:fw(""+R(a.name)),label:b,checked:d,value:c+1},void 0)))}
function s7e(){var a='<div class="'+T("waffle-assistant-feedback-dialog-legal")+'"><small><div class="'+T("waffle-assistant-feedback-dialog-legal-information-text")+'">';a=a+'We will use the information you give us to help address technical issues and to improve our services, subject to our  <a href="https://www.google.com/intl/en/policies/privacy/" target="_blank" class="uf-legal-link">Privacy Policy </a>   and  <a href="https://www.google.com/intl/en/policies/terms/" target="_blank" class="uf-legal-link">Terms of Service</a> .</div><div class="'+(T("waffle-assistant-feedback-dialog-product-info-display-text")+
'"><span tabindex="0" role="link">');return S(a+"What will be shared with Google?</span></div></small></div>")}function t7e(a,b){kV.call(this,void 0,b,!0,!0);this.L=a;this.O=a.H;this.H=this.V=this.R=null;this.setTitle("Chart suggestions feedback");this.C.setContent("Submit")}u(t7e,kV);p=t7e.prototype;
p.Ba=function(){kV.prototype.Ba.call(this);Aw(this.Ka(),"waffle-assistant-feedback-dialog");var a=this.L.J();var b=this.O.length,c=this.L.C();za(a);var d='<div class="'+T("waffle-assistant-feedback-dialog-header")+'">';d=d+'Recent suggestions</div><div class="'+(T("waffle-assistant-feedback-dialog-suggestions-radio-buttons-control")+'">');b=Math.max(0,Math.ceil(b));for(var e=0;e<b;e++){var f=e;d+=r7e({name:"waffle-assistant-feedback-dialog-suggestions-radio-buttons",GO:"",checked:f==c,index:f})}d+=
'</div><div class="'+T("waffle-assistant-feedback-dialog-header")+'">';d=d+'Issue</div><div class="'+(T("waffle-assistant-feedback-dialog-feedback-radio-buttons-control")+'">');c=a.length;for(b=0;b<c;b++)d+=r7e({name:"waffle-assistant-feedback-dialog-feedback-radio-buttons",GO:a[b],checked:!1,index:b});d+=r7e({name:"waffle-assistant-feedback-dialog-feedback-radio-buttons",GO:"Other",checked:!1,index:a.length});d+='</div><div class="'+T("waffle-assistant-feedback-dialog-other-feedback-textarea-wrapper")+
'"><textarea class="'+T("waffle-assistant-feedback-dialog-other-feedback-textarea")+" "+T("jfk-textinput")+'" placeholder="'+T("Tell us a bit more")+'"></textarea></div>';a=S(d);Pw(this,aw(a));a=Sw(this);this.qa().Rv(a,vx(s7e),0)};
p.Ha=function(){var a=this;kV.prototype.Ha.call(this);var b=Rw(this);b&&X8a(b,vw(b));this.R=sEe("waffle-assistant-feedback-dialog-suggestions-radio-buttons",this.Ea("waffle-assistant-feedback-dialog-suggestions-radio-buttons-control"));this.va(this.R);for(b=0;b<this.O.length;b++){var c=this.O[b];oZ(this.R,b).qE(this.L.render(c))}this.V=sEe("waffle-assistant-feedback-dialog-feedback-radio-buttons",this.Ea("waffle-assistant-feedback-dialog-feedback-radio-buttons-control"));this.va(this.V);b=this.Ea("waffle-assistant-feedback-dialog-product-info-display-text");
c=new Cx(b);this.va(c);this.getHandler().listen(b,"click",this.eIa).listen(c,"key",function(d){13===d.keyCode&&(a.eIa(),d.stopPropagation())})};p.bB=function(){var a=u7e(this);dmb.Eb(a,a.YNa);kV.prototype.bB.call(this)};function u7e(a){var b=parseInt(oEe(a.R),10)-1,c=parseInt(oEe(a.V),10)-1,d=a.Ea("waffle-assistant-feedback-dialog-other-feedback-textarea");d=pd(d.value)||"[No feedback entered]";return a.L.D(a.O[b]||null,c,d)}
p.eIa=function(){var a=this,b=u7e(this).Fqa;this.H=new q7e(b,this.qa());this.H.setVisible(!0);this.getHandler().listen(this.H,"hide",function(){of(a.H);a.H=null})};p.Ja=function(){kV.prototype.Ja.call(this);of(this.H)};
function v7e(){return S('<div class="waffle-assistant-padded-card"><div class="waffle-assistant-before-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-preview"></div><div class="waffle-assistant-after-chart-preview" tabindex="0"></div><div class="waffle-assistant-chart-highlights"></div></div>')}
function w7e(a,b,c){b=c||b;return S(R(pz({hd:"waffle-assistant-insert-chart-button waffle-assistant-readonly-hidden",content:fw(""+R(uA({icon:"docs-icon-img docs-icon-insert-autovis-chart"},b))),style:4},b))+'<div class="waffle-assistant-button-separator waffle-assistant-readonly-hidden"></div>'+R(pz({hd:"waffle-assistant-zoom-button",content:fw(""+R(uA({icon:"docs-icon-img docs-icon-zoom-in"},b))),style:4},b)))}
function x7e(a,b,c,d){Q.call(this,d);this.O=a;this.D=b;this.C=c;ay(new $x,10).build()}u(x7e,Q);x7e.prototype.YFa=function(a,b){this.F(this.O,2746,a,b)};
function y7e(a){var b=a.W8a,c='<div class="waffle-assistant-facet-section"><div class="waffle-assistant-facet-header"><div class="waffle-assistant-pie-icon"></div><div class="waffle-assistant-facet-top-text">',d='By <span class="waffle-assistant-facet-title">'+(R(a.T1a)+"</span>");a=0==b.length;c=c+d+'</div><div class="waffle-assistant-facet-toggle" tabindex="0"></div></div>';if(a)b=S('<div class="waffle-assistant-facet-by-color-container"><div class="waffle-assistant-faceted-chart waffle-assistant-facet-by-color"></div></div>');
else{d='<div class="waffle-assistant-facet-charts-container">';for(var e=b.length,f=0;f<e;f++){var h=b[f];d+=(0==f%2?'<div class="waffle-assistant-facet-chart-row">':"")+'<div class="waffle-assistant-single-facet"><div class="waffle-assistant-single-facet-title">';d=h?d+R(h):d+"(empty)";d+='</div><div class="waffle-assistant-faceted-chart"></div></div>'+(1==f%2||f==e-1?"</div>":"")}b=S(d+"</div>")}c+='<div class="waffle-assistant-facet-content-wrapper'+(a?" waffle-assistant-facet-white-section":"")+
'">'+b+(qB?'<div class="waffle-assistant-facet-feedback-container"></div><div class="waffle-assistant-facet-thumbs-container"></div>':"")+"</div></div>";return S(c)}function z7e(){LQc.apply(this,arguments)}u(z7e,LQc);z7e.prototype.lla=g("element");function A7e(){AQc.call(this);BQc(this,this);this.Aa="waffle-assistant-dragged-card"}u(A7e,PS);A7e.prototype.contains=function(a){return!!Fc(this.F,function(b){if(b.element==a)return!0})};
A7e.prototype.VZ=function(a){var b=PS.prototype.VZ.call(this,a);a=a.querySelectorAll("CANVAS");for(var c=b.querySelectorAll("CANVAS"),d=0;d<a.length;d++)c[d].getContext("2d").drawImage(a[d],0,0);return b};function B7e(a,b,c,d,e,f,h,k,l,n){x7e.call(this,e,f,h,n);this.V=a;this.L=b;this.ea=c;this.H=d;this.R=k;this.J=l}u(B7e,x7e);B7e.prototype.Ha=function(){x7e.prototype.Ha.call(this);OEe(this.ea,this.Ka(),this.D,this.C,void 0,void 0,this.H)};
B7e.prototype.F=function(a,b,c,d){tJ(this.V).dispatchEvent(new FDe(this.L.copy(),this.H,a,b,c,d,void 0,this.R,this.J))};function C7e(a,b,c,d,e,f){x7e.call(this,c,d,e,f);this.R=a;this.J=b;this.H=null}u(C7e,x7e);C7e.prototype.Ha=function(){x7e.prototype.Ha.call(this);(new nY(hfc,this.J.nk)).send(v(this.L,this,this.J))};C7e.prototype.F=function(a,b,c,d){this.dispatchEvent(new GDe(this.R.clone(),a,this.H,b,c,d))};
C7e.prototype.L=function(a,b){if(b)if(b.Mj())qN.$F(this.Ka(),b);else{a.Wi(b.Ae());jZ(a,a.Ae());var c=(b=a.Ae())?b.toJSON():null,d=ritz.charts.model.GvizChart.create();d.updateChartWrapperJsonString(a.toJSON());c&&d.updateDataTableJsonString(c);OEe(d,this.Ka(),this.D,this.C,void 0,void 0,void 0);this.H=b}};
function D7e(a,b,c,d,e,f,h,k){Q.call(this,k);this.C=a;this.Ua=b;this.La=c;this.Pa=d;this.R=e;this.Ia=f;this.Ra=h;this.H=Of(this.C,23);this.O=E(this.C,22);this.F=E(this.C,26);this.V=[];this.Oa=new mk;this.Aa=this.L=this.D=null;this.Ca=!1;this.Fa=new qz("",this.qa());this.Ga(this.Fa);this.J=this.ea=null}u(D7e,Q);p=D7e.prototype;p.Ba=function(){Q.prototype.Ba.call(this);this.ib(vx(y7e,{T1a:this.F,W8a:this.H}));this.Ka().style.visibility="hidden"};
p.Ha=function(){Q.prototype.Ha.call(this);var a=this.Ea("waffle-assistant-facet-toggle");this.Fa.Wa(a);this.getHandler().listen(this.Ka(),"mousedown",this.FHb).listen(this.Fa,"action",this.Byb);qB&&(this.Aa=new iCe("assistantAutovisFacetFeedback",this.qa()),this.Aa.render(this.Ea("waffle-assistant-facet-feedback-container")),this.D=new nCe(this.qa()),this.Ga(this.D),this.D.render(this.Ea("waffle-assistant-facet-thumbs-container")),oCe(this.D,this.H.length?"Were these charts useful?":"Was this chart useful?"),
this.getHandler().listen(this.D,"thumbs-up",this.HHb).listen(this.D,"thumbs-down",this.GHb));E7e(this,A(z(),"fefsbd"))};p.Bd=g("Ca");p.FHb=function(a){a.stopPropagation()};p.Byb=function(){var a=zw(this.Ea("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden");E7e(this,a);F7e(this,a?2647:2646)};
function E7e(a,b){var c=a.Ea("waffle-assistant-facet-toggle");Ln(c,b?"HIDE":"SHOW");Ew(a.Ea("waffle-assistant-facet-content-wrapper"),"waffle-assistant-facet-charts-wrapper-hidden",!b);Fc(a.Nh("waffle-assistant-faceted-chart"),function(e){Mn(e,b)});a.D&&P(a.D.Ka(),b);var d='Show chart broken down by "'+(a.F+'"');a='Hide chart broken down by "'+(a.F+'"');WY(c,b?a:d)}
function G7e(a,b){var c=a.Nh("waffle-assistant-faceted-chart");1==c.length&&2==b.getTypeOrdinal()&&b.setStackingType(1);var d=E(a.C,28).clone();Nf(d,1);for(var e=Of(a.C,27),f=0;f<e.length;f++)d.addRange(e[f]);for(e=0;e<c.length;e++){f="string"===typeof a.H[e]?a.H[e]:null;var h=b.copy();f?h.setFilter(a.O,f):h.setFacet(a.O,[a.O-1]);var k=a,l=h.getTitle();l||(l=CAe(h));h.setTitle(H7e(k,l,f));k=h.copy();k.setChartDataSource(ritz_api.ChartsApi.createChartDataSource(a.Oa.serialize(d)));PEe(k);l=new B7e(a.Ua,
h,k,d,a.La,a.Pa,a.R,E(a.C,29),a.Ra,a.qa());a.Ga(l);var n=c[e];l.Wa(n);a.V.push(l);I7e(a,n,CAe(h),f);a.ea=k}J7e(a);a.Ka().style.visibility="visible"}function I7e(a,b,c,d){var e=c+(' broken down by "'+(a.F+('" for "'+(d+'"'))));a=c+(' broken down by "'+(a.F+'"'));ww(b,d?e:a)}function H7e(a,b,c){var d=b+(' when "'+(a.F+('" is "'+(c+'"'))));a=b+(' by "'+(a.F+'"'));return c?d:a}
function K7e(a){a.setOption("legend","top");a.setOption("titleTextStyle.fontSize",10);a.setOption("allowAsync",!0);a.setOption("applyAggregateData",void 0);a.setOption("pieSliceTextStyle.fontSize",11);a.setOption("tooltip.textStyle.fontSize",11);"BarChart"==a.Xd()&&a.setOption("isStacked",!0)}function L7e(a){"BarChart"==a.Xd()&&a.setOption("isStacked",!0);a.setOption("applyAggregateData",void 0)}
function J7e(a){a.Ca||Fc(a.V,v(function(b){var c=b.Ka();if(!this.Ia.contains(c)){var d=this.Ia;b=new z7e(c,b);uSc(d,b)}},a))}p.HHb=function(){F7e(this,2649)};p.GHb=function(){F7e(this,2648);this.Aa.show(!0)};function F7e(a,b){if(a.ea)Ygd(a.R,b,new wU,10,a.ea,E(a.C,28));else if(a.J){var c=a.R,d=new wU,e=a.J.Xd();d.F=e;(e=a.J.Ae())?d.C=e.clone():d.C=null;chd(c,b,d,10,a.J,a.J.nk)}}
function M7e(a,b,c,d,e,f,h,k){ZY.call(this,a,k);this.J=fY(a);this.L=b;this.zb=c;this.yb=d;this.R=e;this.Pa=f;this.Jb=h;this.ea=new qz("",this.qa());this.Ga(this.ea);this.Aa=new qz("",this.qa());this.Ga(this.Aa);this.Ra=new mk;this.hb=null;this.La=!1;this.Ya=[];this.Ua=[];this.$a=[];this.Ia=this.C=this.D=this.Ca=null;this.Oa=[];a=rBe(this.Jb,mJ(b));this.F=by(ay(new $x,10),a).build()}u(M7e,ZY);p=M7e.prototype;p.vz=function(a){var b=this;this.isDisposed()||(ritz_api.ChartsApi?(this.hb=a,N7e(this)):ritz_api.RitzEntryPoint.loadChartsApi(function(){b.vz(a)}))};
p.$z=function(){var a=this;if(!this.isDisposed())if(A(z(),"fecpmr"))if(ritz_api.ChartsApi){var b=GAe(this.createChartModel(),E(this.J,28));ww(this.Ka(),b)}else ritz_api.RitzEntryPoint.loadChartsApi(function(){a.$z()});else O7e(this,v(function(c){c=HAe(this.L,c);ww(this.Ka(),c)},this),!1)};p.HE=m(!0);p.AA=m("autovisFeedback");p.yD=m(2208);p.xD=m(2207);p.s8=m("Was this chart useful?");
p.Ba=function(){ZY.prototype.Ba.call(this);$Y(this).appendChild(vx(v7e));rCe(this).appendChild(vx(w7e));if(Kf(this.J,22)){this.C=new D7e(this.J,this.L,this.V,this.yb,this.R,this.Pa,this.Oa,this.qa());this.Ga(this.C,!0);var a=this.C,b=this.Bd();a.Ca=b;J7e(a)}};
p.Ha=function(){ZY.prototype.Ha.call(this);Aw(this.Ka(),"waffle-assistant-card-draggable");var a=this.Ea("waffle-assistant-insert-chart-button");this.ea.Wa(a);WY(a,"Insert chart");a=this.Ea("waffle-assistant-zoom-button");this.Aa.Wa(a);WY(a,"View full size");a=this.Ea("waffle-assistant-before-chart-preview");var b=this.Ea("waffle-assistant-after-chart-preview");this.getHandler().listen(this.Ka(),"keydown",this.DHb).listen(a,"focus",this.oeb).listen(b,"focus",this.fdb).listen(this.ea,"action",this.enb).listen(this.ea.Ka(),
"mousedown",this.$pa).listen(this.Aa,"action",this.nAb).listen(this.Aa.Ka(),"mousedown",this.$pa).listen(this.Ea("waffle-assistant-chart-highlights"),"mousedown",this.$pa).listen(nH(this.L),"Ab",this.EHb);P7e(this);this.R.C(2790,this.F);this.C&&this.R.C(2791,this.F)};p.Eu=function(a){ZY.prototype.Eu.call(this,a);P7e(this);this.Db()&&Q7e(this)};function P7e(a){if(a.Db()){var b=a.Bd();a.ea.setVisible(!b);a=a.qa().Ea("waffle-assistant-button-separator",rCe(a));P(a,!b)}}
p.DHb=function(a){13==a.keyCode&&a.target==this.Ka()&&(a.preventDefault(),a.stopPropagation(),R7e(this,2255))};
function S7e(a){var b=a.Xd(),c=!!E(a.J,14),d=E(a.J,16),e=!!E(a.J,15),f="Histogram"==b;b="PieChart"==b;var h=vm(Of(a.H,4));if(!h[0]||h[0].C==mJ(a.L)){for(var k=1<h.length,l=[],n=0;n<h.length;n++){var q=h[n].rect;q=c!=b?owa(q,new El(q.width,1)):owa(q,new El(1,q.height));Zc(l,q)}c=RK(a.zb).D;var r=[];for(w in Yva)r.push(ooc(c,Yva[w]));var w=Ic(l,function(x){return Ic(r,Fa(Xl,x))});f&&e&&(w=$c(w,1));a.$a=T7e(w.length,b&&0<d||!f&&!b&&e,b&&k);d=RK(a.zb);for(e=0;e<w.length;e++)for(f=a.$a[e],b=0;b<w[e].length;b++)w[e][b]&&
lm(w[e][b])&&(k=Vte(d,w[e][b],"waffle-assistant-styled-rect"),a.va(k),hR(d.V,"default",k,!0),ov(k.Ka(),"background-color",f),k.setVisible(!0),a.Ya.push(k),k=kR(d,w[e][b],"waffle-assistant-styled-border",1,0),a.va(k),unc(k,f),k.setVisible(!0),a.Ua.push(k))}}function U7e(a){pf(a.Ya);pf(a.Ua);a.Ya=[];a.Ua=[];a.$a=[]}p.EHb=function(){this.La&&(U7e(this),S7e(this))};p.eO=function(){ZY.prototype.eO.call(this);this.Ia=Ga();this.La||(S7e(this),this.La=!0)};
p.TI=function(){ZY.prototype.TI.call(this);"number"===typeof this.Ia&&500<Ga()-this.Ia&&this.R.C(2789,this.F);this.Ia=null;U7e(this);this.La=!1};p.oeb=function(){var a=this.Ea("waffle-assistant-chart-highlights");Jv(a)?a.focus():this.Ka().nextSibling&&this.Ka().nextSibling.focus()};p.fdb=function(){this.O&&jCe(this.O)||this.Aa.Ka().focus()};p.enb=function(){R7e(this,2255)};p.$pa=function(a){a.stopPropagation()};p.nAb=function(){tmb.Eb(this,this.F)};p.YFa=function(a,b){R7e(this,2257,a,b)};
function R7e(a,b,c,d){if(A(z(),"fecpmr")){var e=a.createChartModel();tJ(a.L).dispatchEvent(new FDe(e,E(a.J,28),a.V,b,c,d,pj(a.F),E(a.J,29),a.Oa))}else O7e(a,v(function(f){f=new GDe(f,this.V,this.D&&this.D.Ae(),b,c,d,pj(this.F),E(this.J,29),this.Oa);tJ(this.L).dispatchEvent(f)},a),!1)}function V7e(a,b){OEe(b,W7e(a),a.yb,a.R,function(){null!==a.Ca&&(Oj(Mj(),a.Ca),a.Ca=null);a.isDisposed()||(a.hb(),Q7e(a))})}
function Q7e(a){if(!a.Bd()){var b=W7e(a);if(!a.Pa.contains(b)){var c=a.Pa;a=new z7e(b,a);uSc(c,a)}}}function X7e(a,b,c){var d=[];try{var e=a.Ra.serialize(c);d=Ic(FHe(Fa(ritz_api.RitzModelApi.getVerbalHighlightsForProto,e),b).call(ritz_api.RitzModelApi),EHe)}catch(f){d=[]}a=a.Ea("waffle-assistant-chart-highlights");P(a,0<d.length);0<d.length&&(a.appendChild(d[0]),Mn(a,!0))}
p.createChartModel=function(){Y7e(this);var a=ritz.charts.model.ChartImpl.create(),b=E(this.J,28);a.setChartModel(this.Ra.serialize(b.Ok()));a.setChartDataSource(ritz_api.ChartsApi.createChartDataSource(this.Ra.serialize(b)));return a};function Z7e(a){Y7e(a);E(a.J,16);var b=fDe(a.J);b.Zsa(hfc);var c=QCe(a.H);b.hn(c.toString());a.C&&(c=c.clone(),a.C.L=c);return b}function Y7e(a){a.Vd&&(a.Ca=Nj(Mj(),"aaoar"),a.Vd=!1)}
function N7e(a){if(A(z(),"fecpmr")){var b=a.createChartModel(),c=b.copy();PEe(c);X7e(a,b,E(a.J,28));V7e(a,c);a.C&&G7e(a.C,b)}else{var d=gDe(Z7e(a),a.Ea("waffle-assistant-card-inner"));(new nY(hfc,d.nk)).send(function(e){if(e)if(e.Mj())qN.$F(W7e(a),e);else{d.Wi(e.Ae());jZ(d,d.Ae());e=new fr;e.setContext(d.toJSON());var f=!!E(a.J,14);F(e,3,f);var h=E(a.J,16);F(e,4,h);F(e,5,f);F(e,8,0);E(a.J,24)&&(f=E(a.J,25),F(e,9,f));f=vm(Of(a.H,4));for(h=0;h<f.length;h++)e.addRange(qm(f[h].rect,f[h].C));f=(f=d.Ae())?
f.toJSON():null;h=ritz.charts.model.GvizChart.create();h.updateChartWrapperJsonString(d.toJSON());f&&h.updateDataTableJsonString(f);X7e(a,h,e);a.D=d;e=(e=d.Ae())?e.toJSON():null;f=ritz.charts.model.GvizChart.create();f.updateChartWrapperJsonString(d.toJSON());e&&f.updateDataTableJsonString(e);V7e(a,f)}});a.C&&O7e(a,function(e){var f=a.C,h=d;e=new yN(e.toJSON());h=new yN(h.toJSON());var k=f.Nh("waffle-assistant-faceted-chart");if(1<k.length){L7e(e);var l=h;K7e(l);l.setOption("pieSliceText","percentage");
l.setOption("axisFontSize",0);l.setOption("hAxis.title",null);l.setOption("hAxis.textPosition","none");l.setOption("vAxes.0.title",null);l.setOption("vAxes.0.textPosition","none");l.setOption("vAxes.1.title",null);l.setOption("vAxes.1.textPosition","none");l.setOption("legend","none");l.setOption("titleTextStyle.fontSize",0)}else l=e,L7e(l),l.setOption("applyAggregateData",void 0),l.setOption("legend","right"),K7e(h);l=vm(Of(f.C,27));ifc(f.L,l);l=E(f.C,25);for(var n=0;n<k.length;n++){var q="string"===
typeof f.H[n]?f.H[n]:null,r=l.clone(),w=f.O,x=new mr;F(x,1,w);"string"===typeof q&&x.setValue(q);F(r,7,x);f.L.xc("dt",encodeURIComponent(JSON.stringify(f.Oa.serialize(r))));r=new yN(e.toJSON());r.hn(f.L.toString());w=h.clone();w.hn(f.L.toString());x=f;var B=r.getOption("title");B||(B=DAe(r));x=H7e(x,B,q);r.setOption("title",x);w.setOption("title",x);x=new C7e(r,w,f.La,f.Pa,f.R,f.qa());f.Ga(x);B=k[n];x.Wa(B);f.V.push(x);I7e(f,B,DAe(r),q);f.J=w}J7e(f);f.Ka().style.visibility="visible"},!1)}}
function O7e(a,b,c){var d=Z7e(a);(new nY(hfc,d.nk)).send(function(e){e?(e=e.Ae(),c&&d.Wi(e),jZ(d,e),b(d)):b(null)})}p.Xd=function(){return this.J.Xd()};function T7e(a,b,c){var d=b?["#666"]:[];c&&(a/=2);b&&--a;b=dDe("material").colors;for(var e=0;e<a;e++)d.push(b[e%b.length].color);c&&Zc(d,d);return d}function W7e(a){return a.Ea("waffle-assistant-chart-preview")}
function $7e(a,b,c){b=c||b;a=a.title;c='<div class="waffle-assistant-feature-section" tabindex="0" role="region" aria-label="';var d=" "+(T(a)+" Section ");c+=hw(d);c+='"><div class="waffle-assistant-section-header"><div class="waffle-assistant-section-title">'+R(a)+"</div>";c+=R(pz({hd:"waffle-assistant-section-more-button",content:fw("More"),style:4},b));return S(c+'</div><div class="waffle-assistant-section-content"></div><div class="waffle-assistant-section-card-holder"></div></div>')}
function i1(a,b,c,d){Q.call(this,d);this.V=a;this.Za=b;this.Aa=new qz("",this.qa());this.Ga(this.Aa);this.L=new Q(this.qa());this.Ga(this.L);this.C=null;this.La=[];this.ea=this.Ia=!1;this.O=c}u(i1,Q);p=i1.prototype;p.JIa=m(!1);p.Dta=m(!0);p.Ba=function(){Q.prototype.Ba.call(this);this.ib(vx($7e,{title:this.getTitle()}))};
p.Ha=function(){Q.prototype.Ha.call(this);this.L.Wa(this.Ea("waffle-assistant-section-card-holder"));this.Aa.Wa(this.Ea("waffle-assistant-section-more-button"));this.getHandler().listen(this.Aa,"action",this.opb);this.C=this.uza();this.va(this.C);P(a8e(this),this.JIa());this.setVisible(!1)};p.setVisible=function(a){this.Db()&&this.isVisible()!=a&&(P(this.Ka(),a),a&&(P(this.Aa.Ka(),this.QSa()),a=new aj,a=M(a,4,this.q1()),a=bj(new Yi,a),a=by(ay(new $x,10),a).build(),this.O.C(2774,a)))};
p.isVisible=function(){return this.Db()&&Jv(this.Ka())};p.QSa=function(){return this.La.length>this.V};p.uza=function(){return new tZ(this.qa())};p.hO=function(a){this.ea=a;Fc(b8e(this),function(b){b.Eu(a)});$Fe(this.C,a)};p.Bd=g("ea");p.jMa=da();
p.fO=function(a){this.La=a;for(var b=0;b<a.length;b++){if(this.L.Gc()<this.V){var c=this.CQ(a[b]);c.Eu(this.ea);var d=this.L.Gc();c.V=d;this.L.Ga(c,!0)}if(this.Dta()&&(this.C.xF(!1),c=this.CQ(a[b]),c.Eu(this.ea),d=this.C,d.C.push(c),d.$c)){YFe(d,!1);var e=d.O.Gc();c.V=e;d.O.Ga(c,!0);c.pL()}}};function b8e(a){var b=[];a.L.Be(function(c){b.push(c)});return b}function a8e(a){return a.Ea("waffle-assistant-section-content")}p.una=function(){return this.L.J_()};
p.gO=function(){this.La=[];pf(this.L.Zc(!0));this.setVisible(!1);this.Dta()&&(this.C.PX(),this.C.xF(!0))};function c8e(a){a.L.Be(function(b,c){c<this.V&&b.pL()},a)}p.s1=function(a){var b=0;if(this.Ia)this.C.kMa();else if(this.una()){this.setVisible(!0);b=Gv(this.Ea("waffle-assistant-section-header")).height+Gv(a8e(this)).height;for(var c=b8e(this),d=0;d<c.length;d++)b<a&&d<this.V?(this.pFa(c[d]),tCe(c[d],!0),b+=Gv(c[d].Ka()).height):tCe(c[d],!1)}else this.setVisible(!1);return a-b};p.pFa=da();
p.setActive=function(a){(this.Ia=a)||this.C.o6()};p.Rb=g("Ia");p.Nn=function(a){this.C&&YFe(this.C,a)};function d8e(a,b){a.C.jda(b,a.getTitle())}p.opb=function(){this.setActive(!0);this.dispatchEvent("zd")};function e8e(){return S('<div class="waffle-assistant-word-cloud-card"><div class="waffle-assistant-word-cloud-title"></div><div class="waffle-assistant-word-cloud-words-container"></div></div>')}function f8e(a,b){ZY.call(this,a,b);this.C=fY(a)}u(f8e,ZY);p=f8e.prototype;p.$z=da();p.AA=m("assistantWordCloudFeedback");
p.yD=m(2634);p.xD=m(2633);p.Ba=function(){ZY.prototype.Ba.call(this);$Y(this).appendChild(vx(e8e));Aw($Y(this),"waffle-assistant-word-cloud-content-container")};p.vz=function(a){for(var b=Of(this.C,19),c=Of(this.C,20),d=this.Ea("waffle-assistant-word-cloud-words-container"),e=0;e<b.length;e++)if(g8e(this,b,c,e),120<d.clientHeight){g8e(this,b,c,e-1);break}b=this.qa();c=E(this.C,2);c=Yn(b,c);d=this.Ea("waffle-assistant-word-cloud-title");b.appendChild(d,c);a()};
function g8e(a,b,c,d){var e=a.Ea("waffle-assistant-word-cloud-words-container");for(a=a.qa();e.firstChild;)e.removeChild(e.firstChild);for(var f=c[d],h=c[0],k=0;k<=d;k++){0!=k&&e.appendChild(Yn(a," "));var l=a.createElement("SPAN");a.appendChild(l,Yn(a,b[k]));a.appendChild(e,l);Aw(l,"waffle-assistant-word-cloud-word");var n=c[k];l.style.color=0==k%2?"#00695C":"#61443C";l.style.fontSize=(n-f)/(h-f)*15+9+"px"}}
function h8e(a,b,c,d,e,f){var h=Ac(z(),"fmnac");h||(h=20);i1.call(this,h,e,d,f);this.Ca=a;this.H=b;this.Fa=c;this.D=new A7e;this.va(this.D);this.F=null;this.R=0;this.J=null}u(h8e,i1);p=h8e.prototype;p.Ha=function(){i1.prototype.Ha.call(this);this.D.init();this.getHandler().listen(this.D,"drag",this.CHb).listen(this.D,"dragend",this.$k)};p.getTitle=m("Analysis");p.BX=function(a){return 0==a};
p.CQ=function(a){return"WordCloud"==fY(a).Xd()?new f8e(a,this.qa()):new M7e(a,this.Ca,this.H,this.Fa,this.O,this.D,this.J,this.qa())};p.hO=function(a){i1.prototype.hO.call(this,a);a&&EQc(this.D)};p.pFa=function(a){this.getHandler().Lc(a,"content-rendered",this.BHb);this.R++};p.fO=function(a,b){this.J=b||null;i1.prototype.fO.call(this,a,b);var c=a.map(function(d){return fY(d).Xd()});Fc(b8e(this),function(d){d instanceof M7e&&(d.Oa=c)})};p.BHb=function(){0==--this.R&&this.dispatchEvent("vd")};
p.CHb=function(){this.F=Cv(this.D.Ic.target)};p.$k=function(a){var b=this.F,c=RK(this.H).C;if(Kl(rP(c,"page",!1,!1)).contains(b)){var d=RP(c,b.x,b.y,"page");c=TP(c,d,"page");b=new wl(b.x-c.left,b.y-c.top);a.C.getData().YFa(d,b)}this.F=null};p.q1=m(2);
function i8e(a,b,c){b=c||b;a=S;c='<div class="'+T("waffle-assistant-answers-logging-message-container")+'"><div class="'+T("waffle-assistant-answers-logging-message")+'"><span class="'+T("waffle-assistant-answers-logging-text")+'">';c=c+"We're logging your queries and data to improve the feature.</span><div class=\""+(T("waffle-assistant-answers-learn-more")+'">');c=c+'Learn More</div><div class="'+(T("waffle-assistant-answers-logging-opt-out")+'">');c=S(c+"Opt-out for this file</div></div></div>");
return a(c+'<div class="'+T("waffle-assistant-answers-input")+" "+T("waffle-assistant-answers-input-with-icon")+'"><form class="'+T("waffle-assistant-answers-query-box")+'">'+R(gFe(b))+"</form></div>")}
function j8e(a,b,c,d,e,f,h,k,l,n){i1.call(this,1,f,e,n);this.Ya=c;this.$a=b;this.Fa=null;this.Ca=new iy("",new mU,this.qa());this.Ga(this.Ca);this.Oa=new iy("",new mU,this.qa());this.Ga(this.Oa);f=new lQ(a,!0,!0);f=new xDe(f);this.Ra=new vCe(e);this.R=new XGe(this.Ya,f,e);this.H=new aHe(this.R,a,b,c,d,e,this.Za,f,this.Ra,h,k,l,this.qa());this.D=new rY(b,"waffle-assistant-answers-styled-border","waffle-assistant-answers-styled-rect");this.va(this.D);this.F=this.J=null;this.Ua=ay(new $x,10).build();
this.Pa=!1}u(j8e,i1);p=j8e.prototype;p.Ba=function(){i1.prototype.Ba.call(this);var a=vx(i8e);this.qa().appendChild(a8e(this),a)};
p.Ha=function(){i1.prototype.Ha.call(this);var a=this.Ea("waffle-assistant-answers-query-box"),b=this.Ea("waffle-assistant-answers-input-box");this.Oa.Wa(this.Ea("waffle-assistant-answers-logging-opt-out"));this.Ca.Wa(this.Ea("waffle-assistant-answers-learn-more"));this.getHandler().listen(a,"focus",this.otb,!0).listen(a,"blur",this.mtb,!0).listen(a,"mouseover",this.qtb).listen(a,"mouseout",this.ptb).listen(a,"click",this.ntb).listen(b,"input",this.NHb).listen(this.Oa,"action",this.krb).listen(this.Ca,
"action",this.Inb).listen(nH(this.Ya),"Ab",wue(this.OHb,25,this));this.setVisible(null!=this.J);k8e(this,yjb&&zjb&&sB("showAnswersLoggingOptOut"))};p.QSa=m(!1);p.JIa=m(!0);p.Dta=m(!1);p.getTitle=m("Answers");p.q1=m(1);p.BX=function(a){return 3==a||0==a||1==a};
p.fO=function(a,b){ed(a,function(l,n){return E(n,2)-E(l,2)});for(var c=[],d=[],e=null,f=0;f<a.length;f++){var h=Pf(a[f],1);3==h?e=a[f]:0==h?c.push(fY(a[f])):1==h&&d.push(a[f])}if(e&&E(e,2)){f=b||null;h=Kf(e,11)?E(e,11):null;var k=null==h?null:tm(E(e,10));0<Lf(e,4)?l8e(this,tm(eY(e)),E(e,9),k,h,c,d):l8e(this,f,E(e,9),k,h,c,d);this.F||(i1.prototype.fO.call(this,a,b),this.getHandler().listen(this.F,"sqc",this.Fxb))}else this.gO(!0)};
p.CQ=function(a){if(!this.F){var b=FGe(this.R,3);this.F=new VGe(a,this.$a,this.O,this.Ra,b,RGe,"regular",void 0,this.qa())}return this.F};p.uza=g("H");p.una=function(){return this.isVisible()};p.gO=function(a,b,c){this.R.reset();(a||b)&&this.F&&(i1.prototype.gO.call(this,a,b,c),this.F.dispose(),this.F=null);if(a||void 0!==b&&!b)this.F&&(i1.prototype.gO.call(this,a,b,c),this.F.dispose(),this.F=null),this.Db()&&(this.R.reset(),this.J=null,fHe(this.H),this.setVisible(!1),this.Rb()&&qY(this.D));c&&this.H.reset()};
p.Nn=function(a,b){b||YFe(this.H,a)};p.jMa=function(a){this.Fa=a;var b=this.H;b.Ra=a;b.Aa.zB(a);b.zb.zB(a);this.R.L=a};p.setActive=function(a){i1.prototype.setActive.call(this,a);a?tY(this.D,this.J):qY(this.D)};function m8e(a,b){a.Rb()&&(b?qY(a.D):tY(a.D,a.J))}function k8e(a,b){P(a.Ea("waffle-assistant-answers-logging-message-container"),b)}function n8e(a,b){a=a.Ea("waffle-assistant-answers-query-box");Ew(a,"waffle-assistant-answers-query-box-focused",b)}p.OHb=function(){this.Rb()&&tY(this.D,this.J)};
p.otb=function(){n8e(this,!0);tY(this.D,this.J)};p.mtb=function(){n8e(this,!1);this.Rb()||qY(this.D)};p.qtb=function(){tY(this.D,this.J)};p.ptb=function(){this.Rb()||qY(this.D)};p.ntb=function(){o8e(this,"")};p.NHb=function(){var a=this.Ea("waffle-assistant-answers-input-box");0!=a.value.length&&(o8e(this,a.value),a.value="")};p.Fxb=function(a){o8e(this,a.C,!1,!0,a);this.O.C(2652,this.Ua)};
function o8e(a,b,c,d,e){c=void 0===c?!1:c;d=void 0===d?!1:d;a.setActive(!0);a.dispatchEvent("zd");p8e(a,b,c);if(d&&b){var f=new xX,h=void 0,k=!1;e instanceof PGe?(f=wBe(1,e.F,e.D,1),h=e.Sj()):e instanceof lFe&&(f=nHe(e),h=e.F,k=e.C);c=new Wo(function(){eHe(a.H,b,f,h,k)},300);a.va(c);c.start()}}
function p8e(a,b,c,d,e){c=void 0===c?!1:c;d=void 0===d?!1:d;var f=new Wo(function(){var h=a.H;h.D&&vFe(h.D,b,!0);h=a.H;var k=c||!1;h.le=k;h.od.R=k;h.yc.R=k;if(d&&b){h=new xX;k=void 0;var l=!1;e&&(h=nHe(e),k=e.F,l=e.C);eHe(a.H,b,h,k,l)}},300);a.va(f);f.start()}function l8e(a,b,c,d,e,f,h){c=c||new rK;a.J=b;a.R.init(c,b,d,e,f,h);a.R.oU();a.setVisible(null!=b);cHe(a.H,b,c,d,e,a.Pa,f);a.Pa=!1;a.Rb()&&tY(a.D,a.J)}
p.krb=function(a){a.stopPropagation();a.preventDefault();this.Fa&&(mp(wk(xk(this.Fa.We("/answers/logoptout"),v(this.lob,this)),v(this.kob,this)),"POST").Pe(),this.O.C(2663,this.Ua))};p.Inb=function(a){a.stopPropagation();a.preventDefault();Xv("https://docs.google.com/document/d/1VxpmAx5RTnwmeXyj3IuPPYIXg9DYzTS8nz8pi1E_ZJk/preview",{target:"_blank"})};p.lob=function(a){a.qj()&&k8e(this,!1)};p.kob=da();
function q8e(a,b,c){a=S;b=""+R(pz({hd:"waffle-assistant-datavalidation-apply-button",content:"Apply",style:4},c||b));b=S(b);return a('<div class="waffle-assistant-datavalidation-rule-group"><div class="waffle-assistant-datavalidation-details"></div><div class="waffle-assistant-datavalidation-description"></div>'+b+"</div>")}function r8e(a){return S('<div class="waffle-assistant-datavalidation-detail-chip">'+R(a.Y2a)+"</div>")}
function s8e(a,b,c,d){ZY.call(this,a,d);this.D=new rY(b,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");this.va(this.D);this.C=new qz("",this.qa());this.Ga(this.C);this.F=eY(a);this.L=c}u(s8e,ZY);p=s8e.prototype;p.Ba=function(){ZY.prototype.Ba.call(this);$Y(this).appendChild(vx(q8e))};
p.Ha=function(){ZY.prototype.Ha.call(this);var a=this.Ea("waffle-assistant-datavalidation-apply-button");this.C.Wa(a);WY(a,"Apply data validation");this.getHandler().listen(this.C,"action",this.Gdb).listen(this.Ka(),"mouseenter",this.kIb).listen(this.Ka(),"mouseleave",this.lIb);a=Lqe(new aj,UHe(tg(E(E(this.H,13),3))));a=bj(new Yi,a);a=by(ay(new $x,10),a).build();this.L.C(35577,a)};
p.vz=function(a){var b=TN(um(this.F)),c=E(E(this.H,13),3);switch(tg(c)){case 14:var d="Email validation";c=["Is valid email"];break;case 15:d="URL validation";c=["Is valid URL"];break;case 30:d="Date validation";c=["Is valid date"];break;case 24:d="List of items";c=vg(c).map(function(k){return E(k.Mo().getValue(),2)});break;case 1:d="Numeric validation";c=["Greater than "+E(vg(c)[0].Mo().getValue(),3)];break;case 7:d="Numeric validation";c=vg(c);c=["Between "+(E(c[0].Mo().getValue(),3)+(" and "+E(c[1].Mo().getValue(),
3)))];break;case 5:d="Numeric validation";c=vg(c);c=["Equal to "+E(c[0].Mo().getValue(),3)];break;default:d="unrecognized",c=[]}var e=new mB,f=e.text(d)+(" for "+(e.cd("SPAN".toString(),{KX:"waffle-assistant-datavalidation-range"})+e.text(b)+e.ad("SPAN".toString())));Ffa(this.Ea("waffle-assistant-datavalidation-description"),e.format(f));var h=this.Ea("waffle-assistant-datavalidation-details");Fc(c,function(k){k=vx(r8e,{Y2a:k});h.appendChild(k)});b="Suggested data validation: "+(d+(" "+(c.join()+
(" for "+b))));ww(this.Ka(),b);a()};p.$z=da();p.AA=m("assistantDataValidationFeedback");p.yD=m(35551);p.xD=m(35550);p.Gdb=function(){this.dispatchEvent(new YY("sd",this,35549))};p.kIb=function(){tY(this.D,tm(this.F))};p.lIb=function(){qY(this.D)};function t8e(a,b,c,d){i1.call(this,1,b,a,d);this.D=c}u(t8e,i1);p=t8e.prototype;p.getTitle=m("Data Validation");p.BX=function(a){return 6==a};
p.CQ=function(a){var b=E(a,1);switch(b){case 6:return new s8e(a,this.D,this.O,this.qa());default:throw Error("Unsupported recommendation type: "+b);}};p.hO=function(a){i1.prototype.hO.call(this,a);this.setVisible(!a)};p.s1=function(a){return this.Bd()?(this.setVisible(!1),a):i1.prototype.s1.call(this,a)};p.q1=m(4);function u8e(a,b,c){YY.call(this,"qd",a,b);this.D=c}u(u8e,YY);function v8e(a){a=""+R(pz({hd:"waffle-assistant-formatting-edit-button",content:"Edit",style:4},a));return S(a)}
function w8e(a,b,c){a='<div class="waffle-assistant-banding-recommendation"><div class="waffle-assistant-banding-color-picker-container"></div><div class="waffle-assistant-banding-range-wrapper">Alternating colors for <span class="waffle-assistant-banding-range"></span></div>'+(v8e(c||b)+"</div>");return S(a)}
function x8e(a,b,c){return S('<div class="waffle-assistant-conditionalformat-rule-group"><div class="waffle-assistant-conditionalformat-rule-holder" tabindex="0"></div><div class="waffle-assistant-conditionalformat-description"></div>'+v8e(c||b)+"</div>")}function y8e(a,b,c){YY.call(this,"yd",a,b);this.D=c}u(y8e,YY);
function z8e(a,b,c,d){ZY.call(this,a,d);a=Ic(Of(this.H,7),YHe);this.C=new cIe(!1,a,7);this.Ga(this.C);this.L=new qz("",this.qa());this.Ga(this.L);this.ea=b;this.F=!1;this.D=-1;this.R=c}u(z8e,ZY);p=z8e.prototype;p.Ba=function(){ZY.prototype.Ba.call(this);$Y(this).appendChild(vx(w8e))};p.Ha=function(){ZY.prototype.Ha.call(this);this.getHandler().listen(this.L,"action",this.Bjb).listen(this.C,"re",this.jeb);this.ea.C(2768)};
p.vz=function(a){var b=this.Ea("waffle-assistant-banding-color-picker-container");this.C.render(b);dIe(this.C);b=this.Ea("waffle-assistant-banding-range");var c=eY(this.H),d=um(c);Ln(b,TN(d));A8e(this,c);b=this.Ea("waffle-assistant-formatting-edit-button");this.L.Wa(b);a()};p.$z=function(){ww(this.Ka(),"Suggested alternating background colors");this.C.He("Choose a color scheme")};p.AA=m("assistantBandingFeedback");p.yD=m(2672);p.xD=m(2671);
p.Bjb=function(a){FK.dispatchEvent({type:"show-banding-pane-recommendation",yQa:this.H,E2a:fIe(this.C)});a.stopPropagation()};p.jeb=function(a){var b=this;if(!this.F&&eIe(this.C)){var c=this.D;this.D=this.C.Gh();this.D==c?this.dispatchEvent(new y8e(this,2797,function(){b.R.clear()})):this.dispatchEvent(new u8e(this,2673,function(){TDe(b.R,"Alternating colors applied",b.qa(),function(){b.dispatchEvent(new YY("Dd",b,2796))})}));a.stopPropagation()}};
function A8e(a,b){a.F=!0;var c=b.tb();b=um(b);c=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(c,b.rc(),b.mc(),b.Wc(),b.Vc(),7,!1);c.length?(c=ritz_api.RitzModelApi.getBandedRangeByWorkbookRangeId(c[0]),c=(new mk).Kc(zr.xa(),c),c=YHe(c)):c=null;c?(c=gIe(a.C,c),EN(a.C,c?c.getElement():null)):EN(a.C,null);a.D=a.C.Gh();a.F=!1}function B8e(a,b){Kx.call(this,void 0,void 0,b);this.C=a}u(B8e,Kx);
B8e.prototype.Ac=function(a){Kx.prototype.Ac.call(this,a);var b=this.C.Ad;switch(b.length){case 0:break;case 1:var c="one-rule";break;case 2:case 4:c="two-rules";break;default:c="three-rules"}for(var d=0;d<b.length;d++){var e=b[d],f=un("DIV");Bw(f,["waffle-assistant-conditionalformat-format-preview",c]);var h=un("DIV");Aw(h,"waffle-assistant-conditionalformat-format-preview-label");f.appendChild(h);Ln(h,"123");if(Kf(e,2)){var k=E(E(e,2),1);switch(tg(xg(k))){case 9:case 13:k=vg(xg(k))[0];var l=Of(e,
1)[0];Ln(h,xH(k,l.tf(),Pf(l,2),Pf(l,4)))}}sIe(e,f);a.appendChild(f)}};B8e.prototype.Fg=function(){var a=this.C;a.dispatchEvent(new YY("rd",a,2563));return!0};function C8e(a,b){ZY.call(this,a,b);this.C=new qz("",this.qa());this.Ga(this.C);this.Ad=Of(a,6)}u(C8e,ZY);p=C8e.prototype;p.Ba=function(){ZY.prototype.Ba.call(this);$Y(this).appendChild(vx(x8e))};
p.Ha=function(){ZY.prototype.Ha.call(this);var a=this.Ea("waffle-assistant-formatting-edit-button");this.C.Wa(a);WY(a,"Apply and edit conditional format rules");this.getHandler().listen(this.C,"action",this.Edb)};p.vz=function(a){Ln(this.Ea("waffle-assistant-conditionalformat-description"),Pf(this.H,3));var b=this.Ea("waffle-assistant-conditionalformat-rule-holder"),c=new B8e(this,this.qa());this.Ga(c);c.Wa(b);WY(b,"Apply conditional format rules");a()};p.$z=da();p.AA=m("assistantConditionalFormatFeedback");
p.yD=m(2630);p.xD=m(2629);p.Edb=function(){this.dispatchEvent(new YY("rd",this,2563));this.dispatchEvent(new YY("ud",this,2670,void 0,void 0,um(E(this.Ad[0],1,0))));eZb()};function D8e(a,b,c){i1.call(this,2,b,a,c)}u(D8e,i1);p=D8e.prototype;p.getTitle=m("Formatting");p.BX=function(a){return A(z(),"feecfr")&&2==a||4==a};
p.CQ=function(a){var b=E(a,1);switch(b){case 2:return new C8e(a,this.qa());case 4:return new z8e(a,this.O,this.Za,this.qa());default:throw Error("Unsupported recommendation type: "+b);}};p.hO=function(a){i1.prototype.hO.call(this,a);this.setVisible(!a)};p.s1=function(a){return this.Bd()?(this.setVisible(!1),a):i1.prototype.s1.call(this,a)};p.q1=m(3);function j1(a,b,c,d,e){Q.call(this);this.O=a;this.Ua=b;this.La=c;this.J=d;this.C=e}u(j1,Q);j1.prototype.getTableRange=g("La");
j1.prototype.vba=function(a,b,c){this.La=a;this.J=b;this.C=c};j1.prototype.Ha=function(){Q.prototype.Ha.call(this);this.getHandler().listen(this.O.C,"ba",this.Ya)};j1.prototype.Ya=function(){this.Ua.Eb()};function E8e(a,b,c,d){d=void 0===d?!1:d;YY.call(this,"Ad",null,2859);this.R=a;this.O=b;this.D=c;this.F=!!d}u(E8e,YY);E8e.prototype.getTableRange=g("R");
function F8e(a,b){C.call(this);this.F=a;this.H=b;this.C=new rY(a,"waffle-assistant-table-range-border","waffle-assistant-table-range-rect");this.va(this.C);this.D=new rY(a,"waffle-assistant-header-range-border","waffle-assistant-header-range-rect");this.va(this.D)}u(F8e,C);F8e.prototype.Ja=function(){qY(this.C);qY(this.D);C.prototype.Ja.call(this)};
function G8e(a,b,c,d,e,f){Ppc(b);var h=um(d);h=new Sl(h.rc(),h.mc(),Math.min(h.Wc(),h.rc()+6),Math.min(h.Vc(),h.mc()+6));var k=bQ(b),l=RK(a.F).C,n=DO(l,new Ml(h.rc(),h.Wc()),"r",!0,!1,!0,!0)-1,q=DO(l,new Ml(h.mc(),h.Vc()),"c",!0,!1,!0,!0)-1;l.dc()&&--q;n=Math.min(200,n);q=Math.min(c.offsetWidth-2,q);cQ(b,k,q,n);c=j7e(d,e,f);a.H.render(b,h,c);b=a.C;h=d.rc();k=d.mc();switch(e){case 0:h=Math.min(d.Wc(),d.rc()+f);break;case 1:k=Math.min(d.Vc(),d.mc()+f)}d=nm(d.tb(),h,k,d.Wc(),d.Vc());tY(b,tm(d));tY(a.D,
tm(c))}
function H8e(a){var b=a.ZPa,c=a.YPa,d=a.GOa;a=a.uya;return S('<div class="waffle-sidebar-overlay"><div class="waffle-tables-popup" aria-label="'+T(b)+'"><div class="waffle-tables-popup-header"><div class="waffle-tables-popup-title">'+R(b)+'</div></div><div class="waffle-tables-popup-content">'+R(c)+'<div class="waffle-assistant-canvas-container"><canvas class="waffle-assistant-table-canvas"></canvas></div></div><div class="waffle-tables-popup-buttons"><div class="waffle-tables-popup-button waffle-tables-popup-done">'+R(d)+
'</div><div class="waffle-tables-popup-button waffle-tables-popup-cancel">'+R(a)+"</div></div></div></div>")}
function I8e(){var a=S('<div class="waffle-assistant-tables-recommendation"><div class="waffle-assistant-table-range-container"><div class="waffle-assistant-tables-range-wrapper waffle-assistant-tables-data-range-wrapper"><label id="waffle-assistant-tables-data-range-label">Data Range</label><div class="waffle-assistant-tables-edit-sheet-button"></div></div><div class="waffle-assistant-tables-range-error" style="display:none">Invalid range</div></div><div class="waffle-assistant-header-range-container"><div class="waffle-assistant-tables-range-wrapper"><div class="waffle-assistant-tables-edit-headers-button"></div></div></div></div>');a=
""+H8e({ZPa:"Edit data range",YPa:fw(""+a),GOa:"Update",uya:"Cancel"});return S(a)}function J8e(){var a=""+H8e({ZPa:"Improve suggestions",YPa:fw('<div class="waffle-tables-popup-header-message"></div>'),GOa:"No",uya:"Yes"});return S(a)}function K8e(a){a='<div class="waffle-tables-bar-content">For <span class="waffle-assistant-table-bar-range">'+(R(a.Uz)+"</span></div>");return S(a)}
function L8e(a){a='Is <span class="waffle-assistant-table-first-header">'+(R(a.oN)+"</span> a header row, containing titles that describe the columns below?");return S(a)}function M8e(a,b,c,d,e,f,h){j1.call(this,a,Ttb,d,e,f);this.D=(new nP).build();this.va(this.D);this.H=new iy("",new lU,this.qa());this.Ga(this.H);lz(this.D,this.H,Utb);this.F=new iy("",new lU,this.qa());this.Ga(this.F);lz(this.D,this.F,Ttb);this.R=new F8e(b,c);this.va(this.R);this.L=new Bu(this);this.va(this.L);this.ea=h}u(M8e,j1);
M8e.prototype.Ba=function(){this.ib(vx(J8e))};
M8e.prototype.Ha=function(){j1.prototype.Ha.call(this);this.H.Wa(this.Ea("waffle-tables-popup-done"));this.F.Wa(this.Ea("waffle-tables-popup-cancel"));var a=j7e(this.getTableRange(),this.C,1);a=TN(um(a));a=vx(L8e,{oN:a});this.Ea("waffle-tables-popup-header-message").appendChild(a);this.L.subscribe(Utb,"action",this.Aa).subscribe(Ttb,"action",this.V);a=this.Ea("waffle-assistant-table-canvas");var b=this.Ea("waffle-assistant-canvas-container");G8e(this.R,a,b,this.getTableRange(),this.C,this.J);a=this.Ea("waffle-tables-popup");
Ew(a,"waffle-tables-popup-answers-enabled",this.ea);b=new HA(a,this.qa());this.va(b);IA(b);a.focus()};M8e.prototype.V=function(){this.dispatchEvent("Bd")};M8e.prototype.Aa=function(){var a=um(this.getTableRange());switch(this.C){case 0:a=Tl(a.top+1,a.left,a.top+a.height,a.left+a.width);break;case 1:a=Tl(a.top,a.left+1,a.top+a.height,a.left+a.width)}var b=this.J-1,c=this.getTableRange().tf();this.dispatchEvent(new E8e(new mm(c,a),b,this.C));this.dispatchEvent("Bd")};
function N8e(a,b,c,d,e,f,h,k,l,n,q){ZY.call(this,l,q);this.Ua=b;this.Ya=c;this.Oa=d;this.$a=n;this.Ia=e;this.Pa=h;this.L=new iy("",new lU,this.qa());this.Ga(this.L);this.ea=new iy("",new lU,this.qa());this.Ga(this.ea);this.C=this.R=this.F=null;this.Ra=this.Ya.L.C;this.Ca=ay(new $x,66).build();this.La=f;this.Aa=new rY(f,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");this.va(this.Aa);this.hb=Of(l,4);this.D=null}u(N8e,ZY);p=N8e.prototype;p.HE=m(!0);
p.Ba=function(){ZY.prototype.Ba.call(this);$Y(this).appendChild(vx(k7e));rCe(this).appendChild(vx(l7e))};
p.Ha=function(){var a=this;ZY.prototype.Ha.call(this);var b=E(this.H,5);b=BDe(this.Pa,b);this.R=new JDe(b,this.Ra,this.$a);b=this.Ea("waffle-assistant-insert-pivottable-button");this.L.Wa(b);WY(b,"Insert Pivot Table");b=this.Ea("waffle-assistant-zoom-button");this.ea.Wa(b);WY(b,"Preview Pivot Table");this.getHandler().listen(this.L,"action",function(){O8e(a,35619)}).listen(this.ea,"action",this.oMa);this.Eu(this.Bd())};
p.vz=function(a){var b=this.qa();b.re(this.Ea("waffle-assistant-answercard-interpret"),Pf(this.H,3));this.C=b.Ba("CANVAS","waffle-pivottable-pivot-canvas");b.wj(this.C,!0);ww(this.C,"Pivot table canvas");var c=this.Ea("waffle-assistant-answercard-pivot-content");b.appendChild(c,this.C);b=E(this.H,5);this.D=new IDe(c,this.La,this.Ua,this.Oa);this.D.H=b;c=this.Bd();this.D.F=c;this.getHandler().vf(this.C,Zm,this.oMa).listen(this.C,"mousedown",this.nMa).Lc(this.D,"pivot_inserted",this.mIb);KDe(this.R,
this.C);a()};p.mIb=da();p.Eu=function(a){ZY.prototype.Eu.call(this,a);if(this.L&&this.Db()){this.L.setVisible(!a);var b=this.qa().Ea("waffle-assistant-button-separator",rCe(this));P(b,!a)}this.F&&NDe(this.F,this.Bd());this.D&&(a=this.Bd(),this.D.F=a)};p.$z=function(){ww(this.Ka(),"Suggested Pivot Table-"+Pf(this.H,3))};p.AA=m("assistantPivotTableFeedback");p.yD=m(2632);p.xD=m(2631);
function O8e(a,b){Kf(a.H,5)&&A(z(),"fewt")&&Oka(E(a.H,5),1);var c=new ODe(null,E(a.H,5),function(){a.dispatchEvent("close-sidebar");a.Ia.C(b,a.Ca)});FK.dispatchEvent(c)}p.oMa=function(){var a=this;this.Ia.C(35620,this.Ca);this.F=new MDe(this.R,Pf(this.H,3),function(){O8e(a,35621)},function(){a.nMa()},this.qa());this.F.render();this.va(this.F);NDe(this.F,this.Bd())};p.nMa=function(){this.C&&this.C.focus()};p.eO=function(){ZY.prototype.eO.call(this);Ute(this.Aa,vm(this.hb))};
p.TI=function(){ZY.prototype.TI.call(this);qY(this.Aa)};function P8e(a,b,c,d,e,f,h,k,l){i1.call(this,1,f,e,l);this.H=d;this.Ca=b;this.Fa=c;this.F=h;this.Oa=k;this.J=ay(new $x,10).build();a=new lQ(a,!0,!0);this.R=new xDe(a);this.D=null}u(P8e,i1);p=P8e.prototype;p.getTitle=m("Pivot Table");p.BX=function(a){return 1==a};
p.CQ=function(a){var b=E(a,1);switch(b){case 1:return new N8e(this.D,this.Ca,this.Fa,this.H,this.O,this.F,this.R,this.J,a,this.Oa,this.qa());default:throw Error("Unsupported recommendation type: "+b);}};p.fO=function(a,b){E(a[0],5)&&(this.D=b?b:null,i1.prototype.fO.call(this,a,b))};p.q1=m(5);function Q8e(){var a=null,b=new Do(function(){null!==a&&oo(a)});a=no(function(){b.callback()});return b}function R8e(a,b,c){cn.call(this);this.C=chc(mO.getInstance(),a,b,c);this.D=Ko()}u(R8e,cn);
R8e.prototype.update=function(a,b,c){var d=this,e=this.C.C;c&&e&&!Mc(c,function(f){return kwa(f,e.rect)},this)||!a&&e&&c&&1==c.length&&1==c[0].Eh()&&e.rect.contains(c[0])||(this.D.cancel(!0),a&&Dte(this.C),this.D=Q8e(),Go(this.D,function(){return Yte(d.C,b,!0)}))};
function S8e(a,b,c){b=c||b;a=a.iSb;c='<div class="waffle-autovis-lightbox"><div class="waffle-autovis-lightbox-header"><div class="waffle-autovis-lightbox-buttons-wrapper">'+R(pz({content:"INSERT CHART",style:4,hd:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-insert waffle-autovis-lightbox-readonly-hidden"},b));c+=R(pz({hd:"waffle-autovis-lightbox-close",content:fw(""+R(uA({icon:"docs-icon-img docs-icon-close-white"},b))),style:4,title:"Close"},b));c+='</div></div><div class="waffle-autovis-lightbox-content"><div class="waffle-autovis-lightbox-content-inner">';
var d='aria-label="'+hw("Previous chart");d+='"';c+=R(pz({content:fw("&#10094;"),style:4,hd:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-previous",attributes:gw(d)},b));c+='<div class="goog-inline-block waffle-autovis-lightbox-container"></div>';d='aria-label="'+hw("Next chart");d+='"';c+=R(pz({content:fw("&#10095;"),style:4,hd:"goog-inline-block waffle-autovis-lightbox-button waffle-autovis-lightbox-next",attributes:gw(d)},b));c+='</div><div class="waffle-autovis-lightbox-page-count"><span class="waffle-autovis-lightbox-page-number"></span>/'+
R(a)+"</div></div></div>";return S(c)}function T8e(){return S('<div class="waffle-autovis-lightbox-chart"></div>')}function U8e(a,b,c,d,e){Q.call(this,e);this.F=a;this.D=b;this.V=c;this.R=d;this.H=[];this.C=new qz("",this.qa());this.Ga(this.C);this.O=new qz("",this.qa());this.Ga(this.O);this.L=new qz("",this.qa());this.Ga(this.L);this.J=new qz("",this.qa());this.Ga(this.J)}u(U8e,Q);p=U8e.prototype;p.Ba=function(){Q.prototype.Ba.call(this);this.ib(vx(S8e,{iSb:this.F.length}))};
p.Ha=function(){Q.prototype.Ha.call(this);var a=LB.isEnabled();V8e(this,!a);a=this.Ea("waffle-autovis-lightbox-close");this.C.Wa(a);a=this.Ea("waffle-autovis-lightbox-insert");this.O.Wa(a);var b=this.Ea("waffle-autovis-lightbox-previous");this.L.Wa(b);b=this.Ea("waffle-autovis-lightbox-next");this.J.Wa(b);W8e(this);X8e(this,this.D,!1);this.getHandler().listen(document.body,"focusin",this.zIb).listen(this.Ka(),"keydown",this.AIb).listen(tn(),"resize",this.DIb).listen(this.C,"action",this.close).listen(this.O,
"action",this.fnb).listen(this.L,"action",this.CIb).listen(this.J,"action",this.BIb);b=new HA(this.Ka(),this.qa());IA(b);this.va(b);a.focus()};function W8e(a){var b=a.Ea("waffle-autovis-lightbox-content"),c=a.Ea("waffle-autovis-lightbox-content-inner");a=a.Ea("waffle-autovis-lightbox-page-count");var d=sn();a=Gv(a);var e=d.height-a.height-195,f=d.width-200;.75<e/f?(d=f,e=.75*f):d=e/.75;Dv(c,d,e);Dv(b,d,e+a.height+35)}function V8e(a,b){Ew(a.Ka(),"waffle-autovis-lightbox-readonly",b)}
function X8e(a,b,c){c&&HK("Page "+(b+1+(" of "+(a.F.length+"."))));a.H[b]?Y8e(a,b):a.F[b]&&(A(z(),"fecpmr")?(c=a.F[b].createChartModel(),Z8e(a,c,b)):O7e(a.F[b],function(d){if(!a.isDisposed()&&d){var e=d.Ae();e=e?e.toJSON():null;var f=ritz.charts.model.GvizChart.create();f.updateChartWrapperJsonString(d.toJSON());e&&f.updateDataTableJsonString(e);Z8e(a,f,b)}},!0))}function Z8e(a,b,c){var d=a.Ea("waffle-autovis-lightbox-container"),e=vx(T8e);d.appendChild(e);a.H[c]=e;OEe(b,e,a.V,a.R);Y8e(a,c)}
function Y8e(a,b){P(a.H[a.D],!1);P(a.H[b],!0);a.L.Na(0!=b);a.J.Na(b!=a.F.length-1);var c=a.Ea("waffle-autovis-lightbox-page-number");Ln(c,b+1);a.D=b}p.zIb=function(a){!Jn(this.Ka(),a.target)&&a.relatedTarget&&a.relatedTarget.focus()};p.AIb=function(a){27==a.keyCode?this.close():37==a.keyCode||38==a.keyCode?0!=this.D&&X8e(this,this.D-1,!0):39!=a.keyCode&&40!=a.keyCode||$8e(this);a.stopPropagation()};
p.DIb=function(){var a=this.Ea("waffle-autovis-lightbox-container");Bn(a);this.H=[];W8e(this);X8e(this,this.D,!0)};p.fnb=function(){this.close();R7e(this.F[this.D],2256)};p.CIb=function(){0!=this.D&&X8e(this,this.D-1,!0);0==this.D&&this.J.Ka().focus()};p.BIb=function(){$8e(this);this.D==this.F.length-1&&this.L.Ka().focus()};function $8e(a){a.D!=a.F.length-1&&X8e(a,a.D+1,!0)}p.close=function(){this.dispose()};p.ud=function(){Q.prototype.ud.call(this);var a=this.F[this.D];a&&a.Ka()&&a.Ka().focus()};
function a9e(a){var b=a.name;a='<div class="waffle-assistant-quicksum-entry" tabindex="0"><span class="waffle-assistant-quicksum-entry-name" title="'+T(a.title)+'">'+R(b)+'</span><span class="waffle-assistant-quicksum-entry-value"></span><span aria-label="';a+=hw("Press enter to insert formula");return S(a+'"></span></div>')}function b9e(a,b){Q.call(this);this.C=a;this.D=b}u(b9e,Q);p=b9e.prototype;p.Ba=function(){var a=vx(a9e,{name:this.C,title:this.D});this.ib(a)};
p.Ha=function(){Q.prototype.Ha.call(this);var a=this.Ea("waffle-assistant-quicksum-entry-name");WY(a);this.getHandler().listen(this.Ka(),"keypress",this.AHb);P(this.Ka(),!1)};p.getFunctionName=g("C");p.setValue=function(a){Ln(this.Ea("waffle-assistant-quicksum-entry-value"),a||"");P(this.Ka(),!!a)};p.isVisible=function(){return Jv(this.Ka())};p.AHb=function(a){13==a.keyCode&&(a.stopPropagation(),a.preventDefault(),this.dispatchEvent(new Rm("insert",this)))};
function c9e(a,b,c,d,e){Q.call(this,e);this.La=a;this.Fa=b;this.L=c;this.O=d;this.D=a.C;this.Ia=new mk;this.ea=ay(new $x,17).build();this.V=ay(new $x,2).build();this.R=!1;this.F=[];this.C=this.J=null;this.H=[]}u(c9e,Q);
c9e.prototype.Ha=function(){Q.prototype.Ha.call(this);this.Af(new b9e(ritz_api.RitzModelApi.getLocalizedFunctionName("SUM"),"Sum"),0,!0);this.Af(new b9e(ritz_api.RitzModelApi.getLocalizedFunctionName("AVERAGE"),"Average"),1,!0);this.Af(new b9e(ritz_api.RitzModelApi.getLocalizedFunctionName("MIN"),"Minimum"),2,!0);this.Af(new b9e(ritz_api.RitzModelApi.getLocalizedFunctionName("MAX"),"Maximum"),3,!0);this.Af(new b9e(ritz_api.RitzModelApi.getLocalizedFunctionName("COUNTA"),"Count all"),4,!0);this.C=
new vDe(this.Ka(),this.Fa,this.D,this.L);this.C.F=this.R;this.va(this.C);this.getHandler().listen(this,"insert",this.Aa).listen(this.C,"formula_inserted",this.Ca)};
c9e.prototype.refresh=function(a){function b(l){return h?ritz_api.RitzModelApi.renderNumberAsFormattedString(l,k):null}if(qJ(this.D)){if(null==a){var c=tJ(this.D),d=YJ(c);a=nJ(this.D);if(!Lc(d,c.vp,c)){P(this.Ka(),!1);return}c=[];for(var e=0;e<d.length;e++){var f=d[e];f=nm(a,f.rc(),f.mc(),f.Wc(),f.Vc());c.push(f)}a=c}d=[];this.F=[];for(c=0;c<a.length;c++)e=a[c],this.F.push(um(e)),d.push(this.Ia.serialize(e));a=a[0].tb();this.J=null;a!=nJ(this.D)&&(this.J=(a=hJ(this.D,a))?a.Pd():null);if(d=ritz_api.RitzModelApi.quickSum(d)){P(this.Ka(),
!0);a=d.count;c=d.countNumberFormat;var h=1<d.numericCount,k=h?d.valueNumberFormat:null;this.zc(0).setValue(b(d.sum));this.zc(1).setValue(b(d.average));this.zc(2).setValue(b(d.min));this.zc(3).setValue(b(d.max));1<a?this.zc(4).setValue(ritz_api.RitzModelApi.renderNumberAsFormattedString(a,c)):P(this.Ka(),!1);if(this.C){this.C.H=[];this.H=[];for(d=0;d<this.Gc();++d)a=this.zc(d),this.H.push(d9e(this,a.getFunctionName()));this.C.H=this.H}}else P(this.Ka(),!1)}else P(this.Ka(),!1)};
c9e.prototype.Aa=function(a){var b=a.target;a=this.F[0];a=new wl(a.left,a.Wc());b=b.getFunctionName();b=d9e(this,b);a=new Ydd(tJ(this.D),a,b);this.L.C(a);this.O.C(2624,this.V)};c9e.prototype.Ca=function(){this.O.C(2624,this.ea)};function d9e(a,b){var c=a.La.L.D,d=a.J;a=Ic(a.F,function(e){return TN(e,d)});return"="+b+"("+a.join(c)+")"}
function k1(a,b,c,d,e,f,h){gZ.call(this,h);this.Ua=a;this.Jb=b.C;this.Ke=kO(b);this.Ca=c;this.qd=d;this.J=f;this.Vd=e;this.La=new c9e(b,c,d,f,this.qa());this.Ga(this.La);this.L=null;this.yb=this.yc=!1;this.hb=!0;this.Ad=Mj();this.Yb=this.$a=this.Za=null;this.Ia=ay(new $x,10).build()}u(k1,gZ);p=k1.prototype;p.Ba=function(){gZ.prototype.Ba.call(this);this.ib(vx(e9e,{sP:this.Ke}))};
p.Ha=function(){gZ.prototype.Ha.call(this);var a=this.Ea("waffle-assistant-quicksum-panel");this.La.Wa(a);a=this.Ea("waffle-assistant-spinner-container");this.Td.render(a);a=this.Td;a.C="#4285f4";a.Db()&&lCe(a);a=this.Ua.C;this.getHandler().listen(this,"close-sidebar",this.jna).listen(a,"recommender-load-started",this.Vma).listen(a,"recommender-load-ended",this.Uma).listen(a,"recommender-calc-started",this.oma).listen(a,"recommender-calc-ended",this.nma).listen(this.Ea("waffle-assistant-scroll-pane"),
"scroll",wue(this.uba,10,this));a=LB.isEnabled();this.tba(!a)};p.resize=function(){var a=this.Ea("waffle-assistant-sidepane-content");a=Gv(a).height;var b=this.Ea("waffle-assistant-spinner-container");ov(b,"margin-top",a/2-16+"px");this.uba()};p.mMa=da();function f9e(a,b){var c=g9e(a);0!=c.length&&(of(a.L),c=c.filter(function(d){return d instanceof M7e}),b=c.indexOf(b),0<c.length&&-1!=b&&(a.L=new U8e(c,b,a.Vd,a.J,a.qa()),a.L.render(),a.va(a.L),V8e(a.L,a.yb)))}
p.tba=function(a){this.yb=a;Ew(this.Ka(),"waffle-assistant-readonly",a);var b=this.La;b.R=a;b.C&&(b.C.F=a);Ew(b.Ka(),"waffle-assistant-quicksum-panel-readonly",a);this.L&&!this.L.isDisposed()&&V8e(this.L,a)};
p.setVisible=function(a){var b=this.isVisible();gZ.prototype.setVisible.call(this,a);if(a&&!b){var c=Kte(this.Ua.C,a);c?(b=new cde,M(b,1,hm(c,"r")),M(b,2,hm(c,"c")),M(b,3,c.Eh()),c=new lj,Li(c,4,b),b=ey(fy(this.Ia),c).build()):b=this.Ia;this.$a=Cqa(this.Ad,"sett",!1,b);this.Td.setActive(!0);h9e(this)}a||i9e(this,!0)};p.Vma=function(){this.isVisible()&&(i9e(this,!0),this.Td.setActive(!0))};p.Uma=function(){this.isVisible()&&this.Td.setActive(!1)};
p.oma=function(a){this.isVisible()&&(this.J.C(2775,this.Ia),i9e(this,void 0,a.C,a.D),j9e(this)||this.Td.setActive(!0),h9e(this),this.hb=!1)};
p.nma=function(a){if(this.isVisible()){this.J.C(2776,this.Ia);var b=a.C;0<b.length&&(this.Za=Cqa(this.Ad,"serr"));i9e(this,!1);this.Td.setActive(!1);a=a.D;var c=SX(this.Ua.C),d=this.V.C.getActiveGrid();c=!!c&&!!d&&c.tb()!=d.tb();d=ja(this.D);for(var e=d.next();!e.done;e=d.next()){e=e.value;for(var f=[],h=ja(b),k=h.next();!k.done;k=h.next()){k=k.value;var l=Pf(k,1),n;if(!(n=!e.BX(l))&&(n=c)){a:switch(l){case 2:case 4:case 6:l=!1;break a;default:l=!0}n=!l}n||f.push(k)}0<f.length?e.fO(f,a):e.gO(!0)}b=
ja(b);for(a=b.next();!a.done;a=b.next())if(a=a.value,5==Pf(a,1)){this.K5();this.Fa=E(a,12);this.H=eY(a);this.Aa=E(a,11);k9e(this);a=this.H;c=!1;for(d=this.Oa.length-1;0<=d;d--)Ewa(this.Oa[d],a)&&(c=!0,this.Oa.splice(d,1));this.Oa.push(a);a=c;2!=this.Fa||a||l9e(this,!0)}b=g9e(this);0<b.length&&this.yc&&(b[b.length-1].Vd=!0);this.yc=!1;h9e(this);m9e(this);this.uba()}};
function h9e(a){var b=j9e(a),c=Jv(a.Ea("waffle-assistant-quicksum-panel")),d=a.Td.Rb();b=b||c||d;c=a.Ea("waffle-assistant-empty-list");P(c,!b);P(a.Td.Ka(),b)}p.Mc=da();p.Bsa=da();p.Bd=g("yb");p.jna=da();p.NDb=function(){this.Za&&(this.Za.complete(),this.Za=null);this.$a&&(this.$a.complete(),this.$a=null);this.Yb=Ga();this.hb||(this.J.C(2777,this.Ia),this.hb=!0)};
function n9e(){return S('<div class="waffle-assistant-title-bar"><div class="waffle-assistant-title-icon">'+R(Yic({color:"#ffffff",iconSize:"21"}))+'</div><div class="waffle-assistant-title-text">'+R("Explore")+"</div></div>")}
function e9e(a,b,c){b=c||b;a=a||{};c=S;var d=fw('<div class="waffle-assistant-replaceable-title">'+n9e(null,b)+"</div>");var e=e=a||{};e=e.sP;var f='<div class="waffle-assistant-empty-list" style="display: none"><div class="waffle-assistant-empty-list-content" aria-live="polite">'+R(Yic({color:"rgb(46%, 46%, 46%)",iconSize:"40"}))+'<div class="waffle-assistant-empty-list-title">';f+='Get insights instantly</div><div class="waffle-assistant-empty-list-body">';f=(e?f+"To see answers, formatting, and charts in a single click, try adding more data or selecting different cells in your spreadsheet.":
f+"To see formatting and charts in a single click, try adding more data or selecting different cells in your spreadsheet.")+'</div><div class="waffle-assistant-empty-list-learn-more waffle-assistant-empty-list-link"><span>Learn more';f+='</span></div><div class="waffle-assistant-empty-list-link"><a href="https://docs.google.com/spreadsheets/d/1Hh2grfB6rp9OQ2yAIu3S5YF_CCFJGwyqPGveABlOZKg/copy" target="_blank">';f+="Try it out";f+="</a></div></div></div>";e=S(f);e=S('<div class="waffle-sidebar-tables-bar" style="display: none"><div class="waffle-assistant-sidepane-tables-range"></div><div class="waffle-assistant-tables-edit-range-button">Edit</div></div><div class="waffle-assistant-scroll-pane"><div class="waffle-assistant-scroll-pane-content"><div class="waffle-assistant-scroll-pane-feature-content">'+
(e+'<div class="waffle-assistant-spinner-container"></div><div class="waffle-assistant-quicksum-panel" style="display: none"></div><div class="waffle-assistant-features"></div></div><div class="waffle-assistant-expanded-panel" style="display: none"></div></div></div>'));return c(R(FZ(cw({title:d,bk:fw(""+e),id:"autovis",Mu:"waffle-assistant-sidepanel",qea:"waffle-assistant-title",vQ:"waffle-assistant-sidepane-content"},a),b)))}
function o9e(a,b,c,d,e,f,h,k,l,n){j1.call(this,a,Otb,d,e,f);var q=this;this.Ia=n;this.Za=b;this.Fa=d;this.zb=e;this.yb=f;a=um(d);this.H=TN(a);this.L=d.tf();this.Ra=new F8e(b,c);this.va(this.Ra);this.F=this.D=null;this.ea=h;this.R=(new nP).build();this.va(this.R);this.Ca=new iy("",new lU,this.qa());this.Ga(this.Ca);lz(this.R,this.Ca,Qtb);this.Aa=new iy("",new lU,this.qa());this.Ga(this.Aa);lz(this.R,this.Aa,Otb);b=this.O.C.C.Pd();this.V=new qZ(this.Za,function(r,w,x){p9e(q,r,w,x)},!1,"e.g., A2:D5",
!0,b,this.qa());this.Ga(this.V);this.Oa=null;this.Pa=new Bu(this);this.va(this.Pa);this.$a=k;this.hb=l}u(o9e,j1);p=o9e.prototype;p.Ba=function(){this.ib(vx(I8e))};
p.Ha=function(){j1.prototype.Ha.call(this);this.Ca.Wa(this.Ea("waffle-tables-popup-done"));this.Aa.Wa(this.Ea("waffle-tables-popup-cancel"));this.V.render(this.Ea("waffle-assistant-tables-data-range-wrapper"));var a=this.Ea("waffle-range-selection-input");tw(a,"labelledby","waffle-assistant-tables-data-range-label");this.getHandler().listen(a,"keydown",this.qIb).listen(a,"keyup",this.rIb).listen(a,"focusout",this.hyb).listen(this.O.C,"la",this.tIb).listen(this.V,"change",this.sIb);this.Pa.subscribe(Qtb,
"action",this.uIb).subscribe(Otb,"action",this.Neb);q9e(this);a=this.Ea("waffle-tables-popup");Ew(a,"waffle-tables-popup-answers-enabled",this.hb);var b=new HA(a,this.qa());this.va(b);IA(b);a.focus()};p.Ja=function(){of(this.Oa);j1.prototype.Ja.call(this)};function p9e(a,b,c,d){uY(a.$a,null,b,c,d,!1,void 0,function(e){a.Oa=e})}
p.tIb=function(){for(var a=this.O.C,b=!0,c=ja(xUb(a)),d=c.next();!d.done;d=c.next())if((d=d.value)&&d.tb()==this.L){b=!1;break}b&&"number"===typeof mJ(a)&&(this.L=mJ(a),r9e(this,this.L));s9e(this)};function t9e(a){var b=a.Ea("waffle-assistant-table-canvas"),c=a.Ea("waffle-assistant-canvas-container");G8e(a.Ra,b,c,a.getTableRange(),a.C,a.J)}p.Neb=function(){this.dispatchEvent("Bd")};
p.uIb=function(){var a=!Rec.test(this.H);P(this.gb("waffle-assistant-tables-range-error"),a);Ew(this.Ea("waffle-assistant-tables-data-range-wrapper"),"waffle-assistant-tables-range-error-input",a);if(!a){a=this.zb!=this.J||this.yb!=this.C;var b=!wm(this.Fa,this.getTableRange()),c=this.Fa.tb()!=this.getTableRange().tb();if(a||b)a&&this.ea.C(35506),b&&this.ea.C(35507),c&&this.ea.C(35723),this.dispatchEvent(new E8e(tm(this.getTableRange()),this.J,this.C,c));this.dispatchEvent("Bd")}};
function q9e(a){var b=a.Ea("waffle-range-selection-input"),c=um(a.Fa);a.H=TN(c);b.value=a.H;s9e(a);u9e(a);t9e(a)}p.vba=function(a,b,c){j1.prototype.vba.call(this,a,b,c);t9e(this)};function v9e(a){var b=uJ(a.O.C,a.L),c=b.$b(),d=Vec(a.H,b),e=null!=d;e&&(b=zWb(b,d),e=lm(b))&&(c=nze(qm(b,c)),a.vba(c,w9e(a,c),a.C),s9e(a),u9e(a));P(a.gb("waffle-assistant-tables-range-error"),!e)}function w9e(a,b){b=x9e(b,a.C);return a.J>b?b:a.J}
function x9e(a,b){a=0==b?Pf(a,3)-Pf(a,2):Pf(a,5)-Pf(a,4);return 0==a?3:Math.min(a-1,3)}
function s9e(a){if(a.Ia){P(Rn(a.qa(),"waffle-assistant-tables-data-range-label"),!1);of(a.F);a.F=new OZ(void 0,mW.getInstance());a.F.setContent("Data Range");a.Ga(a.F);lz(a.R,a.F,Rtb);a.F.render(a.Ea("waffle-assistant-tables-edit-sheet-button"));a.getHandler().listen(a.F,"action",a.jwb);for(var b=0,c=ja(xUb(a.O.C)),d=c.next();!d.done;d=c.next())if(d=d.value)d.tb()===a.L&&(b=a.F.Fh()),a.F.Nc(new my(d.Pd(),d.tb()));a.F.hf(b)}}
function u9e(a){of(a.D);a.D=new OZ(void 0,mW.getInstance());a.Ga(a.D);lz(a.R,a.D,Ptb);a.D.render(a.Ea("waffle-assistant-tables-edit-headers-button"));a.getHandler().listen(a.D,"action",a.amb);for(var b=x9e(a.getTableRange(),0),c=0;c<=b;c++){var d=(new Wz("{NUM_HEADER_RECORDS, plural,=0 {No rows}=1 {1 row}other {# rows}}")).format({NUM_HEADER_RECORDS:c});a.D.Nc(new my(d))}c=x9e(a.getTableRange(),1);for(d=0;d<=c;d++){var e=(new Wz("{NUM_HEADER_RECORDS, plural,=0 {No columns}=1 {1 column}other {# columns}}")).format({NUM_HEADER_RECORDS:d});
a.D.Nc(new my(e))}c=a.J;a.D.hf(0==a.C?c:c+b+1);a.D.setContent("Headers")}p.hyb=function(){var a=this.Ea("waffle-range-selection-input");this.H!=a.value&&(this.H=a.value,v9e(this))};p.sIb=function(){var a=this.V.getValue();this.H=a;var b=this.Ea("waffle-range-selection-input");b.value=a;b.select();v9e(this)};p.jwb=function(){var a=this.F.getValue();a!=this.L&&(this.L=a,r9e(this,this.L));v9e(this)};
function r9e(a,b){if(a.Ia){var c=uJ(a.O.C,b),d=Yl(YJ(c));ritz_api.TablesApi.getTables(sm(qm(d,b)),function(e){if(e.length){var f=e[0];e=f.getDimensionTableAccessor().getHeaderRange();var h=um(EV(e));e=f.getDimensionTableAccessor().getDimensionTagName();h=hm(h,0==e?"r":"c");f=um(EV(f.getTableRange()))}else f=d,e=h=0;a.C=e;a.J=h;e=TN(f);a.H=e;e=a.Ea("waffle-range-selection-input");e.value=a.H;e.select();v9e(a)})}}
p.qIb=function(a){var b=this.Ea("waffle-range-selection-input");switch(a.keyCode){case 13:a.stopPropagation();a.preventDefault();this.H=b.value;v9e(this);Qtb.Eb();break;case 27:a.stopPropagation(),a.preventDefault(),q9e(this),Otb.Eb()}};p.rIb=function(){this.H=this.Ea("waffle-range-selection-input").value;v9e(this)};p.amb=function(){var a=this.D.Gh(),b=x9e(this.getTableRange(),0);this.vba(this.getTableRange(),a-(0==(a>b?1:0)?0:b+1),a>b?1:0)};
function y9e(a,b,c,d,e,f,h,k,l,n,q,r){k1.call(this,a,b,c,e,d,f,r);this.od=n;this.Qc=h;this.V=b;this.Ya=new Q(this.qa());this.Ga(this.Ya);this.R=new SDe(q);this.va(this.R);this.D=[];this.F=null;this.Ra=new qz("",r,4);Ox(this.Ra,2,!1);this.Ga(this.Ra);this.$c=k;this.Hc=l;this.H=null;this.Fa=0;this.Aa=null;this.zb=new iy("",new lU,this.qa());this.Ga(this.zb);this.fc=new Q(this.qa());this.Ga(this.fc);this.Ec=(new nP).build();this.va(this.Ec);lz(this.Ec,this.zb,Stb);this.ea=this.O=null;this.Oa=[]}
u(y9e,k1);p=y9e.prototype;
p.Ha=function(){var a=this;k1.prototype.Ha.call(this);this.Ya.Wa(this.Ea("waffle-assistant-expanded-panel"));WY(this.C.Ka(),"Close");this.fc.Wa(this.Ea("waffle-assistant-sidepane-tables-range"));k9e(this);this.zb.Wa(this.Ea("waffle-assistant-tables-edit-range-button"));if(kO(this.V)){var b=new j8e(this.Qc,this.Ca,this.Jb,this.qd,this.J,this.R,this.V,this.Hc,this.od,this.qa());this.Ga(b);this.D.push(b)}b=new D8e(this.J,this.R,this.qa());this.Ga(b);this.D.push(b);A(z(),"feedvs")&&(b=new t8e(this.J,
this.R,this.Ca,this.qa()),this.Ga(b),this.D.push(b));b=new P8e(this.Qc,this.Jb,this.V,this.qd,this.J,this.R,this.Ca,this.od,this.qa());this.Ga(b);this.D.push(b);b=new h8e(this.Jb,this.Ca,this.Vd,this.J,this.R,this.qa());this.Ga(b);this.D.push(b);var c=this.Ea("waffle-assistant-features");Fc(this.D,function(d){d.render(c);a.Ya.Ga(d.C,!0)});this.Ra.Wa(this.Ea("waffle-assistant-empty-list-learn-more"));this.getHandler().listen(this.Ra,"action",this.cIb).listen(this,"Bd",this.K5).listen(this,"Ad",this.dIb);
z9e(this)};p.dIb=function(){var a=A9e(this);a&&(a.Pa=!0)};p.cIb=function(){(yu(),vt).Eb(tBd)};function m9e(a){Fc(a.D,function(b){c8e(b)})}function i9e(a,b,c,d){Fc(a.D,function(e){e.gO(b,c,d)})}function j9e(a){return!!Mc(a.D,function(b){return b.una()})}p.uba=function(){var a=this,b=this.Ea("waffle-assistant-scroll-pane").scrollTop+Gv(this.Ea("waffle-assistant-sidepane-content")).height;Fc(this.D,function(c){a.F&&a.F!=c||(c instanceof h8e&&a.getHandler().Lc(c,"vd",a.NDb),b=c.s1(b))})};
function g9e(a){if(a.F)return a.F.C.C;var b=[];Fc(a.D,function(c){Zc(b,b8e(c))});return b}p.tba=function(a){k1.prototype.tba.call(this,a);z9e(this)};p.mMa=function(a){Fc(this.D,function(b){b.jMa(a)})};p.Bsa=function(){var a=this.Ea("waffle-assistant-replaceable-title"),b=this.Ea("waffle-assistant-title");Fv(b,Gv(a).height)};
p.Mc=function(){var a=this,b=this.Ea("waffle-assistant-scroll-pane-feature-content"),c=this.Ea("waffle-assistant-replaceable-title"),d=this.Ya.Ka();if(this.F)this.F.C.setVisible(!1),this.F.setActive(!1),this.F=null,P(d,!1),P(b,!0),qx(c,n9e),uw(c,"label"),this.resize(),HK("Explore Opened");else if(this.F=Mc(this.D,function(e){return e.Rb()}))P(b,!1),P(d,!0),this.F.C.setVisible(!0),d8e(this.F,c),ww(c,this.F.getTitle()),b=this.F.getTitle()+" section expanded.",HK(b);this.Bsa();b=new Wo(function(){var e=
lB.Zw();e&&e.dispatchEvent("resize");a.uba()},300);this.va(b);b.start()};p.setVisible=function(a){var b=this.isVisible();k1.prototype.setVisible.call(this,a);a&&!b&&B9e(this,!0);a||this.R.clear()};p.jna=function(){k1.prototype.jna.call(this);this.F&&this.Mc();this.K5()};p.Vma=function(){k1.prototype.Vma.call(this);B9e(this,!0)};p.Uma=function(){k1.prototype.Uma.call(this);B9e(this,!1)};p.oma=function(a){k1.prototype.oma.call(this,a);B9e(this,!0,a.C)};
p.nma=function(a){k1.prototype.nma.call(this,a);B9e(this,!1)};function C9e(a,b){var c=A9e(a);if(b){var d=A(z(),"feenas");a.O=new o9e(a.V,a.Ca,a.$c,a.H,a.Fa,a.Aa,a.J,a.Hc,null!=c&&c.Rb(),d);a.Ga(a.O);a.O.render(a.getElement())}else a.O&&(a.removeChild(a.O,!0),of(a.O),a.O=null);c&&m8e(c,b)}function l9e(a,b){if(1!=a.Aa){var c=A9e(a);b?(a.ea=new M8e(a.V,a.Ca,a.$c,a.H,a.Fa,a.Aa,null!=c&&c.Rb()),a.Ga(a.ea),a.ea.render(a.getElement())):a.ea&&(a.removeChild(a.ea,!0),of(a.ea),a.ea=null);c&&m8e(c,b)}}
function z9e(a){Fc(a.D,function(b){b.hO(a.Bd())})}function A9e(a){return(a=Mc(a.D,function(b){return b instanceof j8e}))&&a}function B9e(a,b,c){Fc(a.D,function(d){d.Nn(b,c)});b&&(a.H=null,a.Fa=0,a.Aa=null,a.K5(),k9e(a))}
function k9e(a){var b=a.Ea("waffle-sidebar-tables-bar"),c=a.Ea("waffle-assistant-scroll-pane");var d=null;var e=A(z(),"feenas"),f=SX(a.Ua.C);if(a.H||e&&f){if(a.H){var h=um(a.H);f=a.H.tf();e&&(d=hJ(a.V.C,f).Pd())}else h=f.tc().C,d=f.Pd(),a.H=qm(h,f.tb()),a.Aa=0;d=TN(h,d);d=vx(K8e,{Uz:d});a=a.fc.Gb();Bn(a);a.appendChild(d);P(b,!0);Aw(c,"waffle-assistant-tables-scroll-pane")}else P(b,!1),Cw(c,"waffle-assistant-tables-scroll-pane")}p.K5=function(){C9e(this,!1);l9e(this,!1)};
function D9e(a,b,c){a=Eud(a.J);switch(b){case 4:case 5:case 6:case 7:a=ja(a);for(var d=a.next();!d.done;d=a.next())if(d=d.value.Vt(),d.getType()===b)return Pf(d,2)}return c}function E9e(a){switch(a){case 8:return 1;case 1:case 2:return 2;case 4:return 3;case 3:return 4;case 5:return 5;case 6:return 6;case 7:return 7;default:return 0}}function F9e(a,b,c){var d=new Yf,e=new Og;b&&c?(d.setType(b),d.pn(c)):d.setType(E9e(a));F(e,3,d);b=new Gp;F(b,2,10);b.setType(a);F(b,5,e);return b}
function G9e(a,b,c,d){C.call(this);this.F=a;this.H=b;this.D=c;this.C=d}u(G9e,C);
function H9e(a,b,c,d){var e=null==c?null:E(c,1),f=null==c?null:c.fk();f=null==c?null:F9e(I9e(e,f),e,D9e(a.H,e,c.fk()));var h=null==b?null:b.getType();h=null!=h&&0!=h;c=null!=c;if(!h&&!c)return F9e(J9e(a,d));if(h)switch(E(b,4)){case "number":return c?f:F9e(J9e(a,d));case "price":if(c&&4==e)break;return F9e(3);case "datetime":if(!c)return F9e(5);switch(e){case 5:case 6:case 7:return f;default:return F9e(5)}default:return c?f:F9e(J9e(a,d))}return f}
function J9e(a,b){for(var c=0,d=0,e=0,f=0,h=0,k=0,l=0,n=0,q=a.D.rect,r=q.top;r<q.top+q.height&&n<a.C;r++){var w=a.F.Eg(r,b);n++;if(!ttd(w)&&(l++,!CVb(w))){var x=utd(w);if(x&&4===x.getType())d++;else if(ritz_api.RitzModelApi.isPercentageNumberFormat(w.C)){e++;continue}else if(ritz_api.RitzModelApi.isAnyDateOrTimeFormat(w.C)){f++;continue}(w=wVb(w))?(c++,Math.floor(w)==w&&k++):h++}}return.95<h/l?8:.95<d/l?3:.95<e/l?4:.95<f/l?5:.95<k/l?1:.95<c/l?2:0}
function I9e(a,b){switch(a){case 1:return 8;case 2:return b.includes(".0")?2:1;case 3:return 4;case 4:return 3;case 5:return 5;case 6:return 6;case 7:return 7;case 8:return 2;default:return 0}}function K9e(a,b,c,d,e,f){C.call(this);this.L=a;this.O=b;this.H=c;this.D=d;this.J=e;this.bb=f||null}u(K9e,TV);
K9e.prototype.C=function(a){var b=this,c=[],d=new my("Suggestion is incorrect",null,this.bb);d.Jc("apps-menuitem");c.push(d);lz(a,d,this.L,void 0,function(){return L9e(b,"Suggestion is incorrect")},this.D);d=new my("Suggestion is correct but optional",null,this.bb);d.Jc("apps-menuitem");c.push(d);lz(a,d,this.O,void 0,function(){return L9e(b,"Suggestion is correct but optional")},this.D);d=new my("Provide more details",null,this.bb);d.Jc("apps-menuitem");c.push(d);lz(a,d,this.H,void 0,function(){return L9e(b,
"Provide more details")},this.D);c.push(null);d=vx(THe);d=new my(d,null,this.bb);d.Jc("apps-menuitem");c.push(d);lz(a,d,this.H,void 0,function(){return L9e(b,"Provide more details")},this.D);return c};function L9e(a,b){return new iue({description:b},a.J,a.D)}
function l1(a,b,c,d){Q.call(this,d);this.Oa=a;this.F=RK(b);this.C=c;this.L=new rY(b,"waffle-assistant-highlight-styled-border","waffle-assistant-highlight-styled-rect");this.va(this.L);this.V=new rY(b,"waffle-assistant-mouseover-highlight-styled-border","waffle-assistant-mouseover-highlight-styled-rect");this.va(this.V);var e=(new nP).build();this.va(e);this.La=new Bxd(function(){return e},this.qa());this.va(this.La);this.Ya=ay(new $x,76).build();this.D=new ST(this.qa());this.Ga(this.D);this.H=null;
this.R={};this.Pa=new Bu(this);this.va(this.Pa);this.O=this.J=!1}u(l1,Q);p=l1.prototype;p.Ha=function(){var a=this;Q.prototype.Ha.call(this);this.D.Wa(this.Ea("waffle-assistant-card-checkbox"));var b=this.Ka();this.getHandler().listen(this.D,"change",this.RH).listen(b,"mouseenter",this.MB).listen(b,"mouseleave",this.ZNa).listen(b,"click",function(){a.D.Vb(!a.D.isChecked());a.D.dispatchEvent("change")}).listen(b,"keydown",this.NQb);this.Pa.Kb(fmb,Vr,this.MQb);M9e(this)};
p.Ja=function(){Q.prototype.Ja.call(this);this.Jz()};p.RH=function(){this.J=!this.J;this.D.Vb(this.J);this.Jz();this.J?(Lx(this.D,"waffle-assistant-card-unchecked-hovered-checkbox"),this.yF(),this.O||tY(this.L,this.C)):qY(this.L);this.dispatchEvent("waffle-assistant-card-checked")};p.MB=function(){this.O=!0;qY(this.L);tY(this.V,this.C);this.Jz();this.yF();this.D.Vb(!0);this.J||this.D.Jc("waffle-assistant-card-unchecked-hovered-checkbox")};
p.ZNa=function(){this.O=!1;this.J?tY(this.L,this.C):(this.D.Vb(!1),this.Jz());Lx(this.D,"waffle-assistant-card-unchecked-hovered-checkbox");qY(this.V);this.Ka().blur()};p.NQb=function(a){if(32==a.keyCode||13==a.keyCode)this.RH(),a.stopPropagation()};function M9e(a){if(A(z(),"fedpsf")){var b=new uIe(a.qa());a.Ga(b);var c=new K9e(hmb,gmb,fmb,a.Ya,a.R,a.qa());Dxd(a.La,b.Lb(),[c]);b.render(a.Ea("waffle-assistant-card-text"))}}p.MQb=function(){$K.getInstance().C(this.R)};p.isChecked=g("J");
p.Vb=function(a){a!=this.isChecked()&&this.RH()};function N9e(a,b,c,d,e){l1.call(this,a,b,c,e);this.ea=d}u(N9e,l1);p=N9e.prototype;p.Ba=function(){var a=TN(this.C.rect),b=vx(f7e,{sf:a,Cha:this.ea.toUpperCase()});this.ib(b);b={};this.R=(b.recommendationCategory="CATEGORICAL_ANOMALY",b.recommendationRange=a,b)};
p.Ha=function(){l1.prototype.Ha.call(this);var a=this.Ea("jfk-textinput"),b=this.Ka();this.getHandler().listen(a,["mousedown","click","mouseup","keydown"],function(c){return void c.stopPropagation()}).listen(a,"input",this.HQb).listen(b,"click",function(){return a.focus()})};p.RH=function(){O9e(this)?(l1.prototype.RH.call(this),Lx(this.D,"waffle-assistant-card-checkbox-disabled")):(this.D.Vb(!1),this.D.Jc("waffle-assistant-card-checkbox-disabled"))};
p.MB=function(){l1.prototype.MB.call(this);var a=this.D;O9e(this)?(a.Vb(!0),Lx(a,"waffle-assistant-card-checkbox-disabled")):(a.Jc("waffle-assistant-card-checkbox-disabled"),a.Vb(!1));HEc(this.F,this.C.rect.top,this.C.rect.left)};p.HQb=function(){!this.isChecked()&&O9e(this)?(l1.prototype.RH.call(this),Lx(this.D,"waffle-assistant-card-checkbox-disabled")):this.isChecked()&&!O9e(this)&&(l1.prototype.RH.call(this),this.D.Jc("waffle-assistant-card-checkbox-disabled"))};p.Jz=da();p.yF=da();
function O9e(a){return a.Ea("jfk-textinput").value}function P9e(a,b,c,d,e,f){l1.call(this,a,c,d,f);this.ea=e;this.Aa=b}u(P9e,l1);P9e.prototype.Ba=function(){var a=Q9e(this.ea.getType()),b=TN(this.C.rect),c=vx(d7e,{column:ON(this.C.rect.left),Cha:a.toLocaleUpperCase()});this.ib(c);c={};this.R=(c.recommendationCategory="COLUMN_TYPE",c.recommendationRange=b,c.recommendationType=a.toLocaleUpperCase(),c)};
function Q9e(a){switch(a){case 1:return"Number";case 2:return"Number";case 3:return"Currency";case 4:return"Percent";case 5:return"Date";case 6:return"Time";case 7:return"Date time";case 8:return"Text";case 9:return"Email";default:return"Unknown"}}P9e.prototype.MB=function(){l1.prototype.MB.call(this);this.F.rA(this.C.rect.left)};
P9e.prototype.yF=function(){var a=new mk;this.H=ritz_api.GridViewApi.previewRangeWithColumnType(this.F.O.D,this.Aa,sm(rm(this.C)),this.Oa,a.serialize(this.ea));bR(this.F,[this.C.rect])};P9e.prototype.Jz=function(){this.H&&(ritz_api.GridViewApi.clearTransform(this.F.O.D,this.H),this.H=null,this.F.isDisposed()||bR(this.F,[this.C.rect]))};function R9e(a,b,c,d,e){l1.call(this,a,b,c,e);this.Aa=E(d,1);this.Ca=E(d,4);this.ea=d.fk();this.Fa=E(d,5)}u(R9e,l1);
R9e.prototype.Ba=function(){var a=S9e(this.Aa),b=S9e(this.Ca);if("Unknown"===b)switch(this.Aa){case 3:case 4:case 8:b="Number"}var c=TN(this.C.rect);b=vx(c7e,{sf:c,hSb:a.toLocaleUpperCase(),kSb:b.toLocaleUpperCase(),gSb:this.ea,bSb:this.Fa});this.ib(b);b={};this.R=(b.recommendationCategory="NUMBER_FORMAT",b.recommendationRange=c,b.recommendationType=a.toLocaleUpperCase(),b.recommendationPattern=this.ea,b)};
function S9e(a){switch(a){case 1:return"Text";case 2:return"Number";case 3:return"Percent";case 4:return"Currency";case 5:return"Date";case 6:return"Time";case 7:return"Date time";case 8:return"Scientific";default:return"Unknown"}}R9e.prototype.MB=function(){l1.prototype.MB.call(this);this.F.rA(this.C.rect.left)};R9e.prototype.yF=function(){this.H=ritz_api.GridViewApi.previewRangeWithNf(this.F.O.D,sm(rm(this.C)),this.Oa,this.Aa,this.ea);bR(this.F,[this.C.rect])};
R9e.prototype.Jz=function(){this.H&&(ritz_api.GridViewApi.clearTransform(this.F.O.D,this.H),this.H=null,this.F.isDisposed()||bR(this.F,[this.C.rect]))};function T9e(a){var b=new Yf;b.pn(a.ea);b.setType(a.Aa);return b}
function U9e(a,b,c,d,e){l1.call(this,a,b,c,e);this.ea=Of(d,5);this.Ca=Of(d,6);this.Ra=E(d,2);this.Ia=E(d,3);this.Ua=E(d,4);this.Aa=new rY(b,"waffle-assistant-highlight-styled-border-red","waffle-assistant-highlight-styled-rect-red");this.va(this.Aa);this.Fa=new rY(b,"waffle-assistant-mouseover-highlight-styled-border-red","waffle-assistant-mouseover-highlight-styled-rect-red");this.va(this.Fa)}u(U9e,l1);p=U9e.prototype;
p.Ba=function(){var a=TN(this.C.rect),b=vx(i7e,{iRa:this.ea,hRa:this.Ca});this.ib(b);b={};this.R=(b.recommendationCategory="REMOVE_DUPLICATES",b.recommendationRange=a,b.recommendationFirstRow=(this.ea[0]+1).toString(),b)};p.RH=function(){this.J=!this.isChecked();this.D.Vb(this.isChecked());this.Jz();this.isChecked()?(Lx(this.D,"waffle-assistant-card-unchecked-hovered-checkbox"),this.yF(),this.O||V9e(this)):(qY(this.L),qY(this.Aa));this.dispatchEvent("waffle-assistant-card-checked")};
p.MB=function(){this.O=!0;qY(this.L);qY(this.Aa);Ute(this.V,W9e(this));Ute(this.Fa,X9e(this));this.Jz();this.yF();this.D.Vb(!0);this.isChecked()||this.D.Jc("waffle-assistant-card-unchecked-hovered-checkbox");this.F.HG(this.ea[0])};p.ZNa=function(){this.O=!1;this.isChecked()?V9e(this):(this.D.Vb(!1),this.Jz());Lx(this.D,"waffle-assistant-card-unchecked-hovered-checkbox");qY(this.V);qY(this.Fa);this.Ka().blur()};function V9e(a){Ute(a.L,W9e(a));Ute(a.Aa,X9e(a))}
function W9e(a){return a.ea.map(function(b){return new mm(a.C.C,new Sl(b,a.Ra,b+1,a.Ia))})}function X9e(a){return a.Ca.map(function(b){return new mm(a.C.C,new Sl(b,a.Ra,b+1,a.Ia))})}p.yF=function(){bR(this.F,[this.C.rect])};p.Jz=da();function Y9e(a,b,c,d,e){l1.call(this,a,b,c,e);this.Ra=Of(d,1);this.Fa=Of(d,2);this.Aa=Jc(this.Ra,function(f,h){return f+h},0);this.Ca=Jc(this.Fa,function(f,h){return f&&h},!0);this.ea=E(d,3);this.Ia=E(d,4)}u(Y9e,l1);
Y9e.prototype.Ba=function(){var a=TN(this.C.rect),b=vx(e7e,{sf:a,fSb:this.Aa,Y_a:this.Ca,gCb:this.ea,YRb:this.Ia});this.ib(b);b={};this.R=(b.recommendationCategory="TRIM_WHITESPACE",b.recommendationRange=a,b.recommendationNumWhitespaces=this.Aa.toString(),b)};Y9e.prototype.MB=function(){l1.prototype.MB.call(this);this.ea?this.F.rA(this.C.rect.left):HEc(this.F,this.C.rect.top,this.C.rect.left)};
Y9e.prototype.yF=function(){this.isChecked()?this.H=ritz_api.GridViewApi.previewRangeWithApplyTrimWhitespace(this.F.O.D,sm(rm(this.C))):this.H=ritz_api.GridViewApi.previewRangeWithHighlightTrimWhitespace(this.F.O.D,sm(rm(this.C)));bR(this.F,[this.C.rect])};Y9e.prototype.Jz=function(){this.H&&(ritz_api.GridViewApi.clearTransform(this.F.O.D,this.H),this.F.isDisposed()||(this.H=null,this.O?this.yF():bR(this.F,[this.C.rect])))};
function Z9e(a,b,c,d){Q.call(this,d);this.La=a;this.C=b;this.D=c;this.V=[];this.Ca=[];this.Ia=[];this.Fa=[];this.R=[];this.ea=vx(g7e,{link:"https://google.qualtrics.com/jfe/form/SV_4IttoTUHuK1ffw1"});this.Aa=vx(h7e);this.H=un("DIV",["waffle-inline-assistant-sidebar-category"]);Ln(this.H,"Column Types");this.J=un("DIV",["waffle-inline-assistant-sidebar-category"]);Ln(this.J,"Number Format");this.O=un("DIV",["waffle-inline-assistant-sidebar-category"]);Ln(this.O,"Trim Whitespace");this.F=un("DIV",["waffle-inline-assistant-sidebar-category"]);
Ln(this.F,"Anomaly Detection");this.L=un("DIV",["waffle-inline-assistant-sidebar-category"]);Ln(this.L,"Remove Duplicates")}u(Z9e,Q);Z9e.prototype.Ba=function(){Q.prototype.Ba.call(this);Aw(this.getElement(),"waffle-inline-assistant-sidebar-section")};function $9e(a,b,c,d){d.length&&b.appendChild(c);b=ja(d);for(c=b.next();!c.done;c=b.next())a.Ga(c.value,!0)}
function a$e(a){var b=a.Gb();pf(a.Zc(!0));b.contains(a.ea)&&pf(b.removeChild(a.ea));b.contains(a.Aa)&&pf(b.removeChild(a.Aa));b.contains(a.F)&&pf(b.removeChild(a.F));b.contains(a.J)&&pf(b.removeChild(a.J));b.contains(a.H)&&pf(b.removeChild(a.H));b.contains(a.O)&&pf(b.removeChild(a.O));b.contains(a.L)&&pf(b.removeChild(a.L));a.Ca=[];a.V=[];a.Ia=[];a.Fa=[];a.R=[]}function b$e(a){var b=[];a.Be(function(c){b.push(c)});return b}
function c$e(a,b,c){b=c||b;a=a||{};c='<div class="'+T("waffle-inline-assistant-sidebar-container")+'"><div class="'+T("waffle-inline-assistant-sidebar-empty-container")+'"><div class="'+T("waffle-inline-assistant-sidebar-empty-message")+'">';c=c+'None detected</div><div class="'+(T("waffle-inline-assistant-sidebar-empty-check-container")+'"><img class="'+T("waffle-inline-assistant-sidebar-empty-check")+'" src="https://www.gstatic.com/images/icons/material/system_gm/svg/done_24px.svg"></div></div><div class="'+
T("waffle-inline-assistant-sidebar-accepted-container")+'"><div class="'+T("waffle-inline-assistant-sidebar-accepted-message")+'">');var d='Applied suggestions<br><br><a href="https://google.qualtrics.com/jfe/form/SV_4IttoTUHuK1ffw1" class="'+(T("waffle-inline-assistant-sidebar-survey-link")+'" target="_blank">Take a brief survey to let us know how we\'re doing!</a>');c=c+d+('</div><div class="'+T("waffle-inline-assistant-sidebar-empty-check-container")+'"><img class="'+T("waffle-inline-assistant-sidebar-empty-check")+
'" src="https://www.gstatic.com/images/icons/material/system_gm/svg/done_24px.svg"></div></div></div>');d=""+R(pz({hd:"waffle-inline-assistant-sidebar-accept",content:"Accept checked",style:2},b));a=""+R(FZ(cw({title:"Data cleanup suggestions",bk:fw(c),Sd:!0,id:"inlineassistant",Mu:"waffle-inline-assistant-sidebar",oC:fw(""+R(uA({icon:"docs-icon-img docs-icon-explore-green"},b))),jR:fw(d),ZQ:!0},a),b));return S(a)}
function d$e(a,b,c,d,e){gZ.call(this,e);this.J=d;this.D=new Z9e(a,b,c,e);this.Ga(this.D);this.H=(new nP).build();this.va(this.H);this.F=new qz(void 0);this.Ga(this.F)}u(d$e,gZ);p=d$e.prototype;p.Ha=function(){gZ.prototype.Ha.call(this);this.getHandler().listen(this.D,"waffle-assistant-card-checked",this.Ofb);PDe(this,!0);var a=this.Ea("waffle-inline-assistant-sidebar-empty-container");P(a,!1);a=this.Ea("waffle-inline-assistant-sidebar-accepted-container");P(a,!1);this.F.Wa(this.Ea("waffle-inline-assistant-sidebar-accept"))};
p.Ba=function(){var a=vx(c$e);this.ib(a);a=this.Gb();this.D.render(a)};p.setVisible=function(a){var b={};hv(this.J,(b.ee=a,b));this.isVisible()!==a&&(gZ.prototype.setVisible.call(this,a),a?PDe(this,!0):a$e(this.D))};p.Ofb=function(){var a=b$e(this.D).some(function(b){return b.isChecked()});emb.Na(a)};
p.initialize=function(a,b,c,d,e,f,h,k,l,n,q){emb.Na(!1);PDe(this,!1);var r=this.H,w=this.F;var x=new lj;M(x,23,b.length+d.length+f.length+k.length+n.length);x=ey(ay(new $x,76),x).build();lz(r,w,emb,void 0,void 0,x);a$e(this.D);r=this.Ea("waffle-inline-assistant-sidebar-accepted-container");P(r,!1);r=this.Ea("waffle-inline-assistant-sidebar-empty-container");w=this.F.Ka();if(a&&(b.length&&c.length||0!==d.length||f.length&&h.length||k.length&&l.length||0!==n.length)){P(r,!1);P(w,!0);if(b.length&&c.length)for(r=
this.D,w=0;w<c.length;w++)x=new R9e(r.D,r.C,b[w],c[w]),r.Ca.push(x);if(0!==d.length)for(b=this.D,c=0;c<d.length;c++)r=new P9e(b.D,a,b.C,d[c],e[c]),b.V.push(r);if(f.length&&h.length)for(a=this.D,d=0;d<h.length;d++)e=new Y9e(a.D,a.C,f[d],h[d]),a.Ia.push(e);if(k.length&&l.length)for(f=this.D,h=0;h<l.length;h++)a=new U9e(f.D,f.C,k[h],l[h]),f.Fa.push(a);if(0!==n.length)for(k=this.D,l=0;l<n.length;l++)f=new N9e(k.D,k.C,n[l],q[l]),k.R.push(f);n=this.D;q=n.Gb();q.appendChild(n.ea);5>=V6e(n.La).getValue()&&
q.appendChild(n.Aa);$9e(n,q,n.H,n.V);$9e(n,q,n.F,n.R);$9e(n,q,n.L,n.Fa);$9e(n,q,n.J,n.Ca);$9e(n,q,n.O,n.Ia)}else P(r,!0),P(w,!1),a$e(this.D)};function e$e(a,b,c){KK.call(this,150);this.fb=a;this.F=b;this.C=c}u(e$e,KK);
e$e.prototype.yd=function(){for(var a=new RIb,b=0;b<this.C.length;b++){var c=this.C[b],d=this.F[b],e=new TG,f=this.fb.$b();d=qm(d,f);F(e,1,d);switch(c.H){case 134:c=c.yd();F(e,4,c);break;case 138:c=c.yd();F(e,3,c);break;case 1:c=c.yd();F(e,2,c);break;case 151:c=c.yd();F(e,6,c);break;case 55:c=c.yd();F(e,5,c);break;default:continue}Mf(a,1,e)}return a};e$e.prototype.Zf=m(!1);function f$e(a,b,c,d,e){vY.call(this,a,c);this.C=a;this.H=b;this.F=d;this.D=e}u(f$e,vY);p=f$e.prototype;
p.initialize=function(a,b,c,d,e,f,h,k,l,n,q){this.C.initialize(a,b,c,d,e,f,h,k,l,n,q)};p.show=function(){wY(this);this.C.setVisible(!0)};p.UH=function(){var a=new lj,b=b$e(this.C.D).length;M(a,23,b);this.D.C(36588,ey(ay(new $x,76),a).build());a=ja(b$e(this.C.D));for(b=a.next();!b.done;b=a.next())this.D.C(36583,g$e(b.value));vY.prototype.UH.call(this)};p.isVisible=function(){return this.Hf().isVisible()};p.Hf=function(){return amb};p.Lo=function(){return bmb};
function g$e(a){var b=new lj;if(a instanceof R9e){M(b,21,1);var c=T9e(a).fk();M(b,22,c);M(b,24,a.Ca)}else a instanceof Y9e?M(b,21,2):a instanceof N9e?M(b,21,3):a instanceof U9e&&M(b,21,4);return ey(ay(new $x,76),b).build()}function h$e(a){return b$e(a.C.D).map(function(b){return b.isChecked()})}function i$e(a){this.F=a;this.O=!1;this.Aa=[];this.ea=[];this.L=[];this.J=[];this.La=[];this.Ia=[];this.Fa=[];this.Ca=[];this.QC=[];this.uQ=[];this.D=this.C=this.R=this.V=null;this.H=[]}
i$e.prototype.getTableRange=g("R");
function j$e(a,b,c,d,e,f,h,k,l,n,q){C.call(this);this.D=a;this.L=b;this.Fa=c;this.Xa=d;this.$a=e;this.Oa=h;this.Ua=k;this.V=f;chc(this.V,this.D,this.$a,this.Xa);this.Za=l;this.Ya=n;this.hb=q;this.Aa=this.F=null;this.C=new i$e(null!=this.J);this.Ca=!1;this.J=null;this.La=this.Ia=!1;this.H=gY(this.L);this.ea=new Map;this.R=new Wo(this.VKa,void 0,this);this.va(this.R);this.O=null;this.Pa=new dn(this);this.va(this.Pa);this.Pa.listen(this.L,"selectionChange",this.KQb).listen(this.V,"recommender-calc-ended",
this.L1).listen(nH(this.D.C),"jb",this.Ktb).listen(this.D.C,"ba",this.LQb).listen(nH(this.D.C),"Yb",this.Vob).listen(this.L,"inputBoxActivate",this.IQb).listen(this.L,"inputBoxDeactivate",this.JQb);this.Ra=new Bu(this);this.va(this.Ra);this.Ra.Kb(EB,Vr,this.Eob).Kb(jmb,Vr,this.gIa).Kb(imb,Vr,this.Gsb).Kb(emb,Vr,this.ycb)}u(j$e,C);function k$e(a,b){return a.H?b.filter(function(c){c=tm(eY(c));return c.C!=a.H?!1:gO(a.D,c.C||a.H,c.rect,!1)}):[]}function l$e(a){of(a.J);a.J=null}p=j$e.prototype;
p.Gsb=function(){l$e(this);var a=EA(this.hb,"See these suggestions also by using the toolbar menu Data -> Cleanup suggestions.",this.L.qa());a.render();a.setVisible(!0);m$e(this)};p.Eob=function(){this.Ca=!0;this.VKa();n$e(this);m$e(this)};function n$e(a){if(a.F)a.F.show();else if(cO(a.D)){var b=new d$e(a.D.F,a.L,a.D.L.C,a.Ua);a.va(b);b.render();a.F=new f$e(b,a.D,a.Za,a.Ya,a.Fa);a.va(a.F);a.F.show()}}
p.ycb=function(){var a=this.F,b=cO(a.H);if(b){for(var c=[],d=[],e=ja(b$e(a.C.D)),f=e.next();!f.done;f=e.next())if(f=f.value,f.isChecked()){var h=f.C.rect;if(f instanceof R9e)c.push(new uBd(b,h,T9e(f)));else if(f instanceof P9e){var k=new ig,l=h.mc();F(k,1,l);l=h.Vc();F(k,2,l);c.push(new uBd(b,h,E(E(f.ea,5),3)));d.push(h);c.push(new wBd(b,[k],f.ea))}else f instanceof Y9e?c.push(new vBd):f instanceof U9e?(k=new ig,l=h.mc(),F(k,1,l),l=h.Vc(),F(k,2,l),c.push(new vIe(b,h,[k],f.Ua,f.ea.concat(f.Ca)))):
f instanceof N9e&&(k=O9e(f))&&c.push(new Chd(b,new wl(h.left,h.top),k));d.push(h);a.D.C(36577,g$e(f))}else a.D.C(36578,g$e(f));0<c.length&&a.F.C(new e$e(b,d,c));a=a.C;a$e(a.D);b=a.Ea("waffle-inline-assistant-sidebar-accepted-container");P(b,!0);P(a.F.Ka(),!1)}this.C.C=null;this.Aa=this.C.D=null};p.IQb=function(){this.Ia=!0;this.R.stop()};p.JQb=function(){this.Ia=!1;this.O=null!=this.J?1E3:5E3;this.R.start(this.O)};
p.gIa=function(){this.Ca=!1;l$e(this);m$e(this);var a=cO(this.D);if(a){var b=[];if(this.C.C&&(b=k$e(this,this.C.C.C),!this.H))return;var c=this.C.getTableRange();if(c)var d=o$e(a,c.rect);else(d=o$e(a,a.F))&&(c=tm(EV(d.getTableRange())));this.Aa=[];var e=[],f=[],h=[],k=[],l=[],n=[],q=[],r=[],w=[],x=[];b=ja(b);for(var B=b.next();!B.done;B=b.next()){var N=B.value;B=tm(eY(N));this.Aa.push(B);switch(E(N,1)){case 7:N=E(N,14);var Z=E(N,1),ba=N.fk();ba=D9e(this.D.F,Z,ba);N.pn(ba);l.push(N);e.push(B);x[B.rect.left-
c.rect.left]=N;break;case 8:N=E(N,15);q.push(N);h.push(B);break;case 9:N=E(N,16),r.push(N),k.push(B)}}if(A(z(),"fects")&&c)for(b=new G9e(a,this.D.F,c,100),B=c.rect,N=B.left;N<B.left+B.width;N++)Z=H9e(b,w[N],x[N],N),0!=Z.getType()&&(n.push(Z),f.push(new mm(c.C,Tl(0,N,a.Yf(),N+1))));n$e(this);this.F&&(a=V6e(this.D.F),a.setValue(a.getValue()+1),this.F.initialize(d,e,l,f,n,h,q,k,r,this.C.QC,this.C.uQ));a=this.C;a.V=d;a.Aa=e;a.ea=l;a.L=f;a.J=n;a.La=h;a.Ia=q;a.Fa=k;a.Ca=r}};
p.LQb=function(){var a=gY(this.L);if(a&&this.H){this.C.F=null!=this.J;var b=null!=this.F&&this.F.isVisible();this.C.O=b;this.F&&(b=h$e(this.F),this.C.H=b,b=this.F,b.Hf().isVisible()&&b.UH());this.ea.set(this.H,this.C);null!=this.J&&this.Fa.C(36590);l$e(this);this.Aa=null;this.R&&this.R.stop();this.O=null;this.H=a;if(this.ea.has(a))if(this.C=this.ea.get(a),this.ea.get(a).F){if(a=RK(this.L))b=this.C.C?this.C.C.C:[],this.J=b7e(a,this.L,this.Oa,this.C.getTableRange(),b,this.C.QC.length)}else{if(this.ea.get(a).O){a=
this.C.V;b=this.C.Aa;var c=this.C.L,d=this.C.La,e=this.C.Fa,f=this.C.QC;if(a&&(b.length||c.length||d.length||e.length||f.length)&&(n$e(this),this.F&&(this.F.initialize(a,b,this.C.ea,c,this.C.J,d,this.C.Ia,e,this.C.Ca,this.C.QC,this.C.uQ),a=this.C.H,b=b$e(this.F.C.D),b.length==a.length)))for(c=0;c<b.length;c++)b[c].Vb(a[c])}}else this.C=new i$e(!1)}};
p.Ktb=function(a){if(a.C){var b=cO(this.D);if(b){var c=b.F;a.C.some(function(h){return c.intersects(h)&&20<=h.height&&4<=h.width&&100<=h.height*h.width})?(this.La=!0,this.R.start(500)):!this.La&&this.R.Rb()&&(this.O=null!=this.J?1E3:5E3,this.R.start(this.O));if(this.C.D){b={};a=ja(a.C);for(var d=a.next();!d.done;b={oW:b.oW},d=a.next()){b.oW=d.value;d=this.C.QC;for(var e=this.C.uQ,f=0;f<d.length;f++)d[f].rect.intersects(b.oW)&&(d.splice(f,1),e.splice(f,1));this.C.QC=d;this.C.uQ=e;if(this.C.D.intersects(b.oW)&&
(!this.Aa||null!=this.J||!this.Aa.some(function(h){return function(k){return h.oW.equals(k.rect)}}(b)))){this.Aa=this.C.D=null;null!=this.J?(this.O=1E3,this.R.start(this.O)):this.C.C=null;break}}}}}};p.KQb=function(){fO(this.D)&&(this.O=this.O||500,this.R.start(this.O))};
p.L1=function(a){this.La=!1;if((A(z(),"fenfts")||A(z(),"fetws")||A(z(),"ferds")||A(z(),"fecad"))&&!this.Ia){var b=this.V.C,c=RK(this.L);if(this.H)if(a&&c&&b&&this.H&&b.C===this.H?(this.C.C=a,this.C.D=b.rect):(this.C.C=null,this.C.D=null),this.C.R=b,this.Ca)this.gIa();else{a=a?k$e(this,a.C):[];var d=this.C.QC.length,e=a.length+d;if(!b||2>e)p$e(this);else if(!this.F||!this.F.isVisible()){e=0<d;for(var f=0,h=ja(a),k=h.next();!k.done;k=h.next())k=k.value,7==E(k,1)&&(e=e||E(E(k,14),3),f++);e?2>d&&2>f?
p$e(this):(null!=this.J?(c=this.J,c.J=b,Z6e(c,a),c.H=d,b=TN(c.J.rect),b=A(z(),"feadpdp")?vx(W6e,{sf:b,eca:c.D,hca:c.F,fca:c.C,cca:c.H}):vx(X6e,{sf:b,AOa:c.D+c.F+c.C+c.H}),a=c.Ea("waffle-assistant-popup-suggestion-text-container"),c.qa().Zc(a),c.qa().appendChild(a,b)):(this.Fa.C(36324,q$e(a.length)),this.J=b7e(c,this.L,this.Oa,b,a,d)),this.C.F=null!=this.J):p$e(this)}}}};function p$e(a){null!=a.J&&(a.Fa.C(36589),l$e(a))}function q$e(a){var b=new lj;M(b,23,a);return ey(ay(new $x,76),b).build()}
function m$e(a){a.H&&U6e(a.D.F.L,a.D.D.F,a.H)}p.Vob=function(a){if(a&&a.O&&(this.Fa.C(36595),A(z(),"fecad")&&a.O instanceof zOc)){var b=a.O,c=b.D;a=c.tf();var d=new mm(a,new Sl(Pf(c,2),Pf(c,4),Pf(c,3),Pf(c,5)));b=Pf(Pf(b.F,3),4);c=null;if(a!=this.H){if(c=r$e(this,a),!c)return}else c=this.C;var e=c.QC.findIndex(function(f){return f.equals(d)});-1==e?(c.QC.push(d),c.uQ.push(b)):c.uQ[e]=b;a!=this.H?this.ea.set(a,c):this.C=c}};
function r$e(a,b){var c=null;b&&(c=a.ea.has(b)?a.ea.get(b):new i$e(!1));return c}
p.VKa=function(){if(this.H){if(!this.Ca){var a=this.D.F.L;if(!Ei(a.C,2,!0))return;var b=this.D.D.F;a=ja(Ki(a.C,RX,1));for(var c=a.next();!c.done;c=a.next())if(c=c.value,b===L(c,1)&&this.H===c.tb())return}this.O=null;b=cO(this.D);a=TK(this.L);b&&!this.D.Bd()&&this.D.H.C&&!iO(this.D)&&a&&!a.F&&(a=b.F,(c=this.C.D)&&kwa(c,a)?(this.Ca||null!=this.J)&&this.L1(this.C.C):Ine(this.V)?(this.V.reset(),Dte(this.V),ritz_api.TablesApi.getCurrentlyDetectedTables(sm(lze(b.$b()))).length?(b=o$e(b,a))?(b=EV(b.getTableRange()),
this.V.O=b,Nte(this.V,!0,!0,!1,[7,8,9])):this.L1(null):Yte(this.V,!0,!1,[7,8,9])||this.L1(null)):this.L1(null))}};function o$e(a,b){a=ritz_api.TablesApi.getCurrentlyDetectedTables(sm(lze(a.$b())));return a.length?Mc(a,function(c){return um(EV(c.getTableRange())).intersects(b)}):null}
function s$e(a,b,c,d,e,f,h,k,l,n,q){vY.call(this,b,h);var r=this;this.H=a;this.C=b;this.Fa=c;this.Oa=d;this.La=e;this.L=f;this.D=c.C;this.Ia=this.Ca=!1;this.F=null;this.V=k;this.Pa=q;this.J=null;t$e(this);smb.Na(!0);a=new aj;M(a,6,u$e());b=new Yi;bj(b,a);this.ea=ay(by(new $x,b),10).build();this.Aa=-1;a=new Wo(function(){return v$e(r,!1)},100);this.va(a);a.start()}u(s$e,vY);
function t$e(a){var b=nH(a.La);a.Ma.listen(a.Oa,"selectionChange",a.gIb).listen(a.D,"ba",a.eIb).listen(a.D,"la",a.iIb).listen(b,"jb",a.SGa).listen(a.C,"sd",a.Idb).listen(a.C,"rd",a.Hdb).listen(a.C,"qd",a.Fdb).listen(a.C,"yd",a.Utb).listen(a.C,"ud",a.efb).listen(a.C,"Cd",a.mxb).listen(a.C,"zd",a.Fvb).listen(a.C,"td",a.geb).listen(a.C,"Dd",a.jIb).listen(a.H.C,"recommender-confidence-update",a.Ggb).listen(a.C,"Ad",a.hIb);a.O.Kb(LB,Tr,a.fIb).subscribe(MB,"action",a.deb).subscribe(tmb,"action",a.Rwb).subscribe(Ulb,
"action",a.wPa).subscribe(wC,"action",a.Wqb).subscribe(Stb,"action",a.fxb).subscribe(pD,"action",a.UH)}p=s$e.prototype;p.Hf=function(){return umb};p.Lo=function(){return vmb};p.rv=function(a){vY.prototype.rv.call(this,a);tmb.Na(a);v$e(this,!1);!this.Ca&&a&&(this.Ca=!0);var b={};hv(this.Pa,(b.fe=a,b));a||this.C.Mc()};p.rY=function(a){var b=this;this.C.Bsa();var c=new Wo(function(){vY.prototype.rY.call(b,a)},300);this.va(c);c.start()};p.UH=function(){vY.prototype.UH.call(this);w$e(this,!1)};
p.lMa=function(a){this.C.mMa(a);this.H.C.La=a};p.Idb=function(a){var b=a.C.H,c=E(E(b,13),3);b=eY(b);var d=new wg;Usd(d,c);var e=new Fp;F(e,1,d);F(e,3,!0);Wqe(e,!0);this.L.C(new AIe(e,b));m1(this,a.ij(),!1,UHe(tg(c)))};p.deb=function(){var a=this.C.isVisible();this.Hf().setVisible(!a);a||this.C.focus();w$e(this,!a)};function w$e(a,b){b?(m1(a,2253),a.Aa=Ga()):m1(a,2226,!0)}p.wPa=function(){this.C.isVisible()||this.rv(!0)};
p.Wqb=function(a){var b="",c=void 0;a&&a.evt&&(b=a.evt?a.evt.D:"",c=a.evt);var d=A9e(this.C);d&&(d.Rb()?p8e(d,b,!0,!!b,c):(this.wPa(),a=new Wo(function(){o8e(d,b,!0,!!b,c)},1E3),this.va(a),a.start()))};p.Rwb=function(a){f9e(this.C,a)};p.fxb=function(){C9e(this.C,!0)};p.iIb=function(){SX(this.H.C)||(this.H.C.reset(),v$e(this,!1))};p.gIb=function(){if(fO(this.Fa)&&null==this.C.O){var a=SX(this.H.C);a&&mJ(this.D)!=a.tb()||v$e(this,!0)}};
function v$e(a,b,c){if(c){if(!c.length)return;if(1==c.length&&a.J&&c[0].equals(a.J)){a.J=null;return}}var d=a.C;d.isVisible()&&(d.La.refresh(void 0),h9e(d));a.H.update(!b,a.C.isVisible(),c)}
p.Ggb=function(a){var b=a.C,c=b?b.D:null;a=b?b.C:0;var d=!!b&&.9<=b.C,e=b?b.D.rect:null;e=!!e&&e.Eh()>=Ajb&&hm(e,"r")>=Cjb&&hm(e,"c")>=Djb&&e.Eh()<=Bjb;b=!!b&&.6<=b.C&&e;if(b!==this.Ia||c&&!c.intersects(this.F))this.Ia=b,this.F=c,this.Aa=Ga(),smb.Eb({Q$:b,Uz:c});e&&c&&c.rect&&(b=1E3>=c.rect.Eh(),c=ritz_api.RitzModelApi.isFormsRegion(c.C,c.rect.top,c.rect.left,c.rect.height+c.rect.top,c.rect.width+c.rect.left),d=!this.C.isVisible()&&!this.Ca&&d&&b&&!tM(this.Fa.H),c=A(z(),"feeaof")&&c,b=A(z(),"feeaoro")&&
this.Fa.Bd(),d&&(c||b)&&(d=new aj,M(d,1,a),M(d,2,c),M(d,3,b),M(d,5,Fjb),M(d,6,u$e()),a=new Yi,bj(a,d),a=by(ay(new $x,10),a).build(),this.Qxa(a)))};p.Qxa=function(a){var b=this;if(qJ(this.D)&&!lK(tJ(this.D))&&(this.C.yc=!0,!lB.m8().C)){var c=a||this.ea;this.Hf().setVisible(!0);this.V.C(2225,c);m1(this,2253);a=new Wo(function(){b.C.isVisible()||b.V.C(2752,c)},5E3);this.va(a);a.start()}};
function u$e(){switch(Ejb){case "NO_DELAY":return 1;case "DELAY_500MS":return 2;case "DELAY_1S":return 3;case "DELAY_2S":return 4;default:return 0}}p.geb=function(){this.C.Mc()};p.jIb=function(a){var b=a.C,c=eY(b.H);this.J=um(c);Fvd(this.L.D);A8e(b,c);m1(this,a.ij())};p.eIb=function(){qJ(this.D)?(this.C.Na(!0),this.H.C.reset(),v$e(this,!1)):(this.Hf().setVisible(!1),this.H.C.reset(),this.C.Na(!1))};p.fIb=function(){this.C.tba(!LB.isEnabled())};p.SGa=function(a){v$e(this,!1,SJb(a))};
p.Hdb=function(a){var b=tJ(this.D),c=b.$b(),d=[],e=rIe(b);if(e){b=new dq;var f=Pf(e,2);F(b,3,f);f=Pf(e,2);F(b,2,f);e=Pf(e,1);F(b,1,e);d.push(b)}b=a.C.Ad;for(e=0;e<b.length;e++)f=new dq,F(f,2,b[e]),d.push(f);this.L.C(new zIe(d,c));m1(this,a.ij())};
p.Fdb=function(a){var b=a.C,c=fIe(b.C),d=eY(b.H),e=c.qw?c.Zy:null,f=c.C?c.Hy:null,h=d.tb(),k=x$e(d);this.J=um(d);k?(c=new CIe(k,h,this.J,e,c.uv,c.hw,f),LK(c,function(l){l&&a.D.call()}),this.L.C(c)):(c=new xIe(h,this.J,e,c.uv,c.hw,f),LK(c,function(l){l&&a.D.call()}),this.L.C(c));d=new wXd;M(d,1,1);c=new zX;Kqe(c,E(b.H,2));Li(c,5,d);b=rBe(this.F,mJ(this.D));Li(b,46,c);b=by(ay(new $x,10),b).build();this.V.C(a.ij(),b)};
p.Utb=function(a){var b=a.C,c=eY(b.H),d=x$e(c);this.J=um(c);d=new yIe(d);LK(d,function(e){e&&a.D.call();A8e(b,c)});this.L.C(d)};p.hIb=function(a){var b=rm(a.getTableRange()),c=j7e(b,a.D,a.O),d=this.H,e=a.D;Dte(d.C);d.C.O=b;d.C.Ca=c;d.C.Fa=e;Nte(d.C,!0,!0,!1);m1(this,a.ij());a.getTableRange().C!=mJ(this.D)&&(c=a.getTableRange().C,c=uJ(this.D,c))&&(c=nH(c),this.Ma.listen(c,"jb",this.SGa));a.F&&(A9e(this.C)&&A9e(this.C).gO(!0,!1,!0),a=this.C,b=[b],a.isVisible()&&(a.La.refresh(b),h9e(a)))};
function x$e(a){var b=a.tb();a=um(a);b=ritz_api.RitzModelApi.getWorkbookRangeIntersectingIds(b,a.rc(),a.mc(),a.Wc(),a.Vc(),7,!1);return 0<b.length?b[0]:null}p.efb=function(a){var b=a.Ra;kJ(tJ(this.D),b);m1(this,a.ij())};
p.mxb=function(a){var b=a.C;a=a.ij();if(b instanceof pZ||b instanceof VGe||b instanceof N8e)m1(this,a,void 0,void 0,b.iH());else{var c=g9e(this.C),d=new zX,e=E(b.H,2);c=c.indexOf(b);M(d,1,c);Kqe(d,e);e=new Yi;Li(e,46,d);if(b instanceof M7e){(d=b.D)?(b=y$e(this,b,d),b=dhd(b,d,d.nk)):b=null;if(!b)return;Li(e,39,b)}else if(b instanceof f8e){var f=b.H;c=new uXd;if(b instanceof f8e)b=1;else throw Error("Unknown text analysis card type.");f=Of(fY(f),20).slice(0,10);M(c,2,f||[]);M(c,1,b);Li(d,3,c)}e=by(ay(new $x,
10),e).build();this.V.C(a,e)}};p.Fvb=function(){this.C.Mc()};function y$e(a,b,c){a=g9e(a.C).filter(function(f){return f instanceof M7e});var d=a.map(function(f){return f.Xd()}),e=a[0]&&E(a[0].J,29);return bhd(c,a.indexOf(b),b.D&&b.D.Ae(),d,e)}
function m1(a,b,c,d,e){e=void 0===e?10:e;if(a.F){var f=O(pj(a.ea),aj,58).getTableRange();if(c||!f||f.tb()!=a.F.C||f.mc()!=a.F.rect.mc()||f.rc()!=a.F.rect.rc()||f.Vc()!=a.F.rect.Vc()||f.Wc()!=a.F.rect.Wc()){f=new aj;M(f,6,u$e());var h=qBe(a.F);Li(f,7,h);c&&(M(f,8,1E3*(Ga()-a.Aa)),null!=a.C.Yb&&M(f,10,1E3*(Ga()-a.C.Yb)));d&&Lqe(f,d);c=new Yi;bj(c,f);a.ea=ay(by(new $x,c),e).build()}}a.V.C(b,a.ea)}function z$e(){zK.apply(this,arguments)}u(z$e,zK);p=z$e.prototype;p.eab=function(){return R8e};p.T9a=function(){return y9e};
p.H$a=function(){return j$e};p.B$a=function(){return t7e};p.S9a=function(){return s$e};p.O9a=function(){return m7e};DK("assistant",z$e);
