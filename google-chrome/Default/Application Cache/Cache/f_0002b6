function H7f(a,b){F(a,1,b)}function I7f(){var a=qM.getInstance();return new eo(function(b,c){Zse(a,"/dbx/schedules",function(d){var e=new mk;e.Hg=!0;d=e.Kc(T7b.xa(),d.Ee());b(d)},c)})}function J7f(a){var b=qM.getInstance(),c=new mk;c.Hg=!0;var d=c.serialize(a);return new eo(function(e,f){rM(b,"/dbx/createSchedule",[],d,function(h){c.Hg=!0;h=c.Kc(N7b.xa(),h.Ee());e(h)},f)})}
function K7f(a){var b=qM.getInstance(),c=new mk;c.Hg=!0;var d=c.serialize(a);return new eo(function(e,f){rM(b,"/dbx/updateSchedule",[],d,function(h){c.Hg=!0;h=c.Kc(R7b.xa(),h.Ee());e(h)},f)})}function L7f(a){if(!ritz_api.BigSheetsApi.isExternalDataForDbObject(a)||ritz_api.BigSheetsApi.isExternalDataForDatasourceSheetPreview(a))return!1;a=ritz_api.BigSheetsApi.getDbObjectTypeForExternalDataSourceId(a);return f$b.has(a)}
function M7f(a){var b=[];a=ja(a.C.keys());for(var c=a.next();!c.done;c=a.next())c=c.value,L7f(c)&&b.push(c);return b}function N7f(a){if(tM(a.L))return[];var b=[];a.C.forEach(function(c,d){U9b.has(c.D)&&L7f(d)&&b.push(d)});return b}function O7f(a,b){b=b.map(function(c){return new f8b(c.Jy(),c.Rh())});W9b(a,b,!1)}function P7f(a,b,c,d){hud(a.F,b,function(e){var f=e.filter(function(h){return 3==h.Rh().getState()});O7f(a,f);c(e)},function(e){O7f(a,e);d(e)})}function Q7f(a){a.Db()&&dMe(a.H)}
function R7f(){return S('<svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20"><g fill="none" fill-rule="evenodd" transform="translate(-2 -2)"><polygon points="0 0 24 0 24 24 0 24"/><path fill="#188038" fill-rule="nonzero" d="M22,4 L22,10 L16,10 L16,8 L18.91,8 C17.53,5.61 14.96,4 12,4 C7.58,4 4,7.58 4,12 C4,16.42 7.58,20 12,20 C16.42,20 20,16.42 20,12 L22,12 C22,17.52 17.52,22 11.99,22 C6.47,22 2,17.52 2,12 C2,6.48 6.47,2 11.99,2 C15.27,2 18.17,3.58 20,6.01 L20,4 L22,4 Z M13,12 L13,6 L11,6 L11,13 L15.97,16.49 L17.23,14.94 L13,12 Z"/></g></svg>')}
function S7f(a,b){gMe.call(this,a,b)}u(S7f,gMe);S7f.prototype.R=function(){this.refresh()};S7f.prototype.refresh=function(){if(this.Db()){var a=YB.isEnabled();a=this.J&&this.L&&a&&0<N7f(this.F).length;this.C.Na(a)}};S7f.prototype.O=m("Refresh all");function T7f(a,b,c){b=c||b;a=a||{};a=""+R(FZ(cw({title:"Refresh data",Mu:"waffle-dataconnector-refresh-sidepane",oC:fw(""+R(R7f())),bk:fw('<div class="'+T("waffle-dataconnector-refresh-sidepane-container")+'"><div class="'+T("waffle-dataconnector-refresh-sidepane-refresh-widget")+'"></div></div><div class="'+T("waffle-dataconnector-refresh-sidepane-backdrop")+'"></div>'),ZQ:!0,jR:fw('<div class="'+T("waffle-dataconnector-refresh-sidepane-footer-wrapper")+'"></div>')},a),b));return S(a)}
function U7f(){return S('<div class="'+T("waffle-dataconnector-refresh-sidepane-stale-widget")+'">'+R(R7f())+'<div class="'+T("waffle-dataconnector-refresh-sidepane-stale-widget-title")+'">This panel is out of sync</div><div class="'+T("waffle-dataconnector-refresh-sidepane-stale-widget-info")+'">Reload to continue</div><div class="'+T("waffle-dataconnector-refresh-sidepane-stale-widget-button-wrapper")+'"></div></div>')};function V7f(){return S('<div class="'+T("waffle-dataconnector-refresh-all-pane")+'"><div class="'+T("waffle-dataconnector-refresh-all-datasources-container")+'"></div></div>')}function W7f(){return S('<div class="'+T("waffle-dataconnector-refresh-all-dbobject-list-items-container")+'"></div><div class="'+T("waffle-dataconnector-refresh-all-dbobject-list-footer-container")+'"></div>')}
function X7f(a,b,c){b=c||b;return S('<div class="'+T("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title")+'"></div>'+W7f(null,b))}function Y7f(){return S('<div class="'+T("waffle-dataconnector-refresh-all-dbobject-list-footer")+'"><div class="'+T("waffle-dataconnector-refresh-all-dbobject-list-footer-bytes-wrapper")+'"></div><div class="'+T("waffle-dataconnector-refresh-all-dbobject-list-footer-button-wrapper")+'"></div></div>')}
function Z7f(a){a=a.title;return S('<div class="'+T("waffle-dataconnector-refresh-all-dbobject-item")+'" tabindex="0"><div class="'+T("waffle-dataconnector-refresh-all-dbobject-item-icon-wrapper")+'"><div class="'+T("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh")+'">'+R(Urc(null))+'</div><div class="'+T("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner")+'"></div></div><div class="'+T("waffle-dataconnector-refresh-all-dbobject-item-title")+'">'+R(a)+'</div><div class="'+
T("waffle-dataconnector-refresh-all-dbobject-item-status-wrapper")+'"><div class="'+T("waffle-dataconnector-refresh-all-dbobject-item-timestamp")+'"></div><div class="'+T("waffle-dataconnector-refresh-all-dbobject-item-error")+'">Error</div><div class="'+T("waffle-dataconnector-refresh-all-dbobject-item-loading")+'">Loading\u2026</div><div class="'+T("waffle-dataconnector-refresh-all-dbobject-item-running")+'">Running\u2026</div></div></div>')};function $7f(a,b,c,d){Q.call(this,d);this.D=a;this.H=b;this.L=c;this.J=new Orc;this.C=new XY(!1);this.F=!0}u($7f,Q);p=$7f.prototype;p.Ba=function(){this.ib(vx(Z7f,{title:this.H}));ww(this.Ea("waffle-dataconnector-refresh-all-dbobject-item-title"),this.H)};
p.Ha=function(){Q.prototype.Ha.call(this);Aw(this.Ka(),"waffle-dataconnector-refresh-all-dbobject-item-enabled");this.C.render(this.Ea("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"));this.getHandler().listen(this.Ka(),"click",this.dOa).listen(this.Ka(),"keydown",this.aRb);a8f(this)};
function a8f(a){var b=IV(a.L,a.D);switch(b.getType()){case "invalid-db-object":case "insufficient-access":case "fetch-failed":b8f(a,"waffle-dataconnector-refresh-all-dbobject-item-error");c8f(a);break;case "offline":c8f(a);break;case "loading":b8f(a,"waffle-dataconnector-refresh-all-dbobject-item-loading");d8f(a);break;case "fetching-results":b8f(a,"waffle-dataconnector-refresh-all-dbobject-item-running");d8f(a);break;case "no-results":e8f(a);c8f(a);break;case "fetch-successful":b=b.C.Tt();b=a.J.format(b);
Ln(a.Ea("waffle-dataconnector-refresh-all-dbobject-item-timestamp"),b);ww(a.Ea("waffle-dataconnector-refresh-all-dbobject-item-timestamp"),b);b8f(a,"waffle-dataconnector-refresh-all-dbobject-item-timestamp");c8f(a);break;case "do-not-show":break;default:throw Error("Unexpected DbObjectUiStateType");}}
p.Na=function(a){this.F=a;var b=this.Ka();a?Gw(b,"waffle-dataconnector-refresh-all-dbobject-item-disabled","waffle-dataconnector-refresh-all-dbobject-item-enabled"):Gw(b,"waffle-dataconnector-refresh-all-dbobject-item-enabled","waffle-dataconnector-refresh-all-dbobject-item-disabled")};function b8f(a,b){e8f(a);P(a.Ea(b),!0)}
function c8f(a){a.C.setActive(!1);P(a.Ea("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"),!1);P(a.Ea("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh"),!0)}function d8f(a){a.C.setActive(!0);P(a.Ea("waffle-dataconnector-refresh-all-dbobject-item-icon-refresh"),!1);P(a.Ea("waffle-dataconnector-refresh-all-dbobject-item-icon-spinner"),!0)}p.aRb=function(a){13===a.keyCode&&this.dOa()};p.dOa=function(){if(this.F){var a=new pH("refresh-db-object-request");a.kBa=this.D;this.dispatchEvent(a)}};
function e8f(a){["waffle-dataconnector-refresh-all-dbobject-item-timestamp","waffle-dataconnector-refresh-all-dbobject-item-error","waffle-dataconnector-refresh-all-dbobject-item-loading","waffle-dataconnector-refresh-all-dbobject-item-running"].forEach(function(b){return P(a.Ea(b),!1)})};function f8f(a,b,c,d,e){Q.call(this,e);this.L=new Set(a);this.J=b;this.H=[];this.F=c;this.D=this.C=null;d&&(this.C=new g8f(this.qa()),this.D=new xLe(this.F,this.qa(),!0,!0));this.O=new Map([[1,0],[2,0],[3,0],[4,0],[5,0]])}u(f8f,Q);f8f.prototype.Ba=function(){this.D?(this.D.render(),this.ib(this.D.Ka()),this.D.setContent(vx(W7f))):this.ib(vx(X7f))};
f8f.prototype.Ha=function(){var a=this;Q.prototype.Ha.call(this);this.D||Ln(this.Ea("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title"),this.F);h8f(this);var b=this.getHandler();this.H.forEach(function(c){b.listen(c,"refresh-db-object-request",function(d){d=d.kBa;U9b.has(IV(a.J,d).D)&&jnb.Eb([d])})});this.C&&(this.C.render(this.Ea("waffle-dataconnector-refresh-all-dbobject-list-footer-container")),b.listen(this.C,"action",this.R))};
function h8f(a){var b=a.Ea("waffle-dataconnector-refresh-all-dbobject-list-items-container");a.L.forEach(function(c){var d=ritz_api.BigSheetsApi.getDbObjectTypeForExternalDataSourceId(c);d=i8f(a,d);c=new $7f(c,d,a.J,a.qa());a.H.push(c);c.render(b)})}function i8f(a,b){switch(b){case 1:return"Pivot table "+j8f(a,1);case 2:return"Chart "+j8f(a,2);case 3:return"Function "+j8f(a,3);case 4:return"Preview";case 5:return"Extract "+j8f(a,5);default:throw Error("Unexpected DbObjectType");}}
function j8f(a,b){var c=a.O.get(b);a.O.set(b,c+1);return 0==c?"":c.toString()}f8f.prototype.R=function(){var a=this,b=Array.from(this.L).filter(function(c){return U9b.has(IV(a.J,c).D)});jnb.Eb(b)};function k8f(a){a.H.forEach(function(b){return a8f(b)})}function l8f(a,b){a.C&&(b=b.filter(function(c){return a.L.has(c.Jy())}),m8f(a.C,b))}function n8f(a,b){a.F=b;a.D?a.D.getHeader().setContent(b):Ln(a.Ea("waffle-dataconnector-refresh-all-dbobject-list-single-datasource-title"),b)}
f8f.prototype.Na=function(a){this.C&&this.C.Na(a);this.H.forEach(function(b){return b.Na(a)})};function g8f(a){Q.call(this,a);this.D=new jV("Refresh",this.qa());this.Ga(this.D);this.C=new cMe;this.Ga(this.C)}u(g8f,Q);g8f.prototype.Ba=function(){this.ib(vx(Y7f))};g8f.prototype.Ha=function(){Q.prototype.Ha.call(this);this.D.render(this.Ea("waffle-dataconnector-refresh-all-dbobject-list-footer-button-wrapper"));this.C.render(this.Ea("waffle-dataconnector-refresh-all-dbobject-list-footer-bytes-wrapper"))};
function m8f(a,b){var c=0;b.forEach(function(d){return c+=parseInt(E(d,2),10)});fMe(a.C,c);a.D.Na(!0)}g8f.prototype.Na=function(a){this.D.Na(a)};function o8f(a,b){Q.call(this,b);this.H=a;this.F=a.R;this.D=new Q;this.Ga(this.D);this.C=[]}u(o8f,Q);o8f.prototype.Ba=function(){this.ib(vx(V7f))};o8f.prototype.Ha=function(){var a=this;Q.prototype.Ha.call(this);this.D.Wa(this.Ea("waffle-dataconnector-refresh-all-datasources-container"));p8f(this);this.getHandler().listen(this.H.C,"ia",function(b){return q8f(a,b)})};
function p8f(a){a.C=[];var b=r8f(a);if(1==b.size){var c=b.entries().next().value;b=c[1];c=s8f(a,c[0]);b=new f8f(b,a.F,c,!1,a.qa());a.C.push(b);a.D.Ga(b,!0)}else{c=ja(b.keys());for(var d=c.next();!d.done;d=c.next()){var e=d.value;d=s8f(a,e);e=b.get(e);d=new f8f(e,a.F,d,!0,a.qa());a.C.push(d);a.D.Ga(d,!0)}}1<a.C.length&&a.C[0].D.getHeader().Vb(!0)}
function r8f(a){var b=new Map;M7f(a.F).forEach(function(c){var d=ritz_api.BigSheetsApi.getDataSourceIdForExternalDataId(c);b.has(d)?b.get(d).push(c):b.set(d,[c])});return b}function s8f(a,b){b=ritz_api.BigSheetsApi.getSheetIdForDatasourceId(b);return hJ(a.H.C,b).Pd()}function t8f(a,b){a.C.forEach(function(c){return l8f(c,b)})}function u8f(a){a.C.forEach(function(b){b.C&&eMe(b.C.C)})}function v8f(a){a.C.forEach(function(b){b.C&&(b=b.C,dMe(b.C),b.D.Na(!1))})}
function w8f(a){a.C.forEach(function(b){return k8f(b)})}o8f.prototype.Na=function(a){this.C.forEach(function(b){return b.Na(a)})};function q8f(a,b){3==hJ(a.H.C,b.Wg).getSheetType()&&(a=a.C.find(function(c){return c.F==b.C}))&&n8f(a,b.ul)};function x8f(a,b,c){b=void 0===b?lW.getInstance():b;Kx.call(this,"",void 0,c);a&&y8f(a);this.C=new z8f(a,b,c);this.Ga(this.C)}u(x8f,Kx);p=x8f.prototype;p.Ba=function(){this.C.Ba();this.ib(this.C.Ka())};p.Nc=function(a){a.Bm(!0);this.C.Nc(a)};p.Dt=function(a,b){a.Bm(!0);this.C.Dt(a,b)};p.yf=function(a){return this.C.yf(a)};p.Fh=function(){return this.C.Fh()};p.Dd=function(){return this.C.C.map(function(a){return a.getValue()})};
function A8f(a,b){a=a.C;for(var c=ja(a.C),d=c.next();!d.done;d=c.next())d.value.Vb(!1);if(0==b.length)a.C=[];else{c=[];d=b.length;for(var e=0;e<a.Fh();e++){var f=a.yf(e),h=f.getValue();if(0<=b.indexOf(h)&&(f.Vb(!0),c.push(f),0==--d))break}a.C=c}a.pC()}p.Lb=function(){return this.C.Lb()};p.Ce=function(a){y8f(a);this.C.Ce(a)};p.Gd=function(a){this.C.Gd(a)};function y8f(a){for(var b=0;b<a.Gc();b++)a.zc(b).Bm(!0)}function z8f(a,b,c){b=void 0===b?lW.getInstance():b;OZ.call(this,a,b,c);this.C=[]}
u(z8f,OZ);z8f.prototype.Ce=function(a){OZ.prototype.Ce.call(this,a);this.C=[];this.pC()};z8f.prototype.Sr=function(a){a.stopPropagation();a=a.target;if(a.isChecked()){var b=this.Lb();Hqe(this.C,a,function(c,d){return cd(Wv(b,c),Wv(b,d))})}else Uc(this.C,a);this.pC();this.dispatchEvent("change")};z8f.prototype.J=function(){var a;0==this.C.length?a=this.F:a=this.C.map(function(b){return b.zg()}).join(", ");return a||""};function B8f(){var a='<div class="'+T("waffle-dataconnector-refresh-schedules-widget")+'"><div class="'+T("waffle-dataconnector-refresh-schedules-header")+'"><div class="'+T("waffle-dataconnector-refresh-schedules-top-section")+'"><div class="'+T("waffle-dataconnector-refresh-schedules-header-title")+'"><span tabindex="0" class="'+T("waffle-dataconnector-refresh-schedules-title")+'">';a=a+'Scheduled refresh</span></div><div class="'+(T("waffle-dataconnector-refresh-schedules-enable-switch")+'"></div></div><div class="'+
T("waffle-dataconnector-refresh-schedules-spinner")+'"></div><div class="'+T("waffle-dataconnector-refresh-schedules-setup-btn")+'"></div><div class="'+T("waffle-dataconnector-refresh-schedules-overview-section")+'"><span class="'+T("waffle-dataconnector-refresh-schedules-overview-text")+'"></span><span class="'+T("waffle-dataconnector-refresh-schedules-edit-btn")+'"></span></div><div class="'+T("waffle-dataconnector-refresh-schedules-fullview-section")+'"><div class="waffle-dataconnector-refresh-schedules-fullview-text"></div><div><span class="'+
T("waffle-dataconnector-refresh-schedules-timezone-setting-btn")+'"></span> - ');a=a+'based on timezone set up in this spreadsheet</div></div></div><div class="'+(T("waffle-dataconnector-refresh-schedules-edit-section")+'"><div class="'+T("waffle-dataconnector-refresh-schedules-edit-section-row")+'"><div class="'+T("waffle-dataconnector-refresh-schedules-frequency-select")+" "+T("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+T("waffle-dataconnector-refresh-schedules-edit-section-row")+
" "+T("waffle-dataconnector-refresh-schedules-edit-section-row-date")+'"><div class="'+T("waffle-dataconnector-refresh-schedules-date-select")+" "+T("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+T("waffle-dataconnector-refresh-schedules-edit-section-row")+'"><div class="'+T("waffle-dataconnector-refresh-schedules-time-select")+" "+T("waffle-dataconnector-refresh-schedules-select")+'"></div></div><div class="'+T("waffle-dataconnector-refresh-schedules-owner-info")+'"></div><div class="'+
T("waffle-dataconnector-refresh-schedules-btns")+'"><div class="'+T("waffle-dataconnector-refresh-schedules-cancel-btn")+'"></div><div class="'+T("waffle-dataconnector-refresh-schedules-save-btn")+'"></div></div></div></div>');return S(a)};var C8f=new gB(7),D8f=new gB(iB.MONTH_DAY_ABBR),E8f=new Wz("{DAY, selectordinal, one {#st}two {#nd}few {#rd}other {#th}}");
function F8f(a,b,c){Q.call(this,c);this.La=a;a=new ry;a.Ga(new my("Every day",1),!0);a.Ga(new my("Every week",2),!0);a.Ga(new my("Every month",3),!0);this.H=new OZ(a,lW.getInstance(),c);Sy(this.H,"Add frequency");this.H.Gd("waffle-dataconnector-refresh-schedule-frequency");this.H.setContent("Frequency");this.Ga(this.H);this.D=new x8f(void 0,lW.getInstance(),c);Sy(this.D.C,"Add date");this.D.Gd("waffle-dataconnector-refresh-schedule-date");this.D.C.setContent("On date");this.Ga(this.D);a=new ry;for(var d=
new Date(Ga()),e=Array(24),f=0;24>f;f++){d.setHours(f,0,0,0);var h=new Date(d.getTime()),k=new Date(d.getTime());k.setHours(h.getHours()+4);k=G8f(h,k);e[h.getHours()]={value:f,label:k}}for(d=0;24>d;d++)f=new my(e[d].label,e[d].value),a.Ga(f,!0);this.J=new OZ(a,lW.getInstance(),c);Sy(this.J,"Add time");this.J.Gd("waffle-dataconnector-refresh-schedule-time");this.J.setContent("Between");this.Ga(this.J);this.O=new pQ("Cancel");this.Ga(this.O);this.R=new PA("Save",c);this.R.Na(!1);this.Ga(this.R);this.V=
new iy("",oO.getInstance(),c);this.Ga(this.V);this.Ca=new iy("Setup now",oO.getInstance(),c);this.Ga(this.Ca);this.Aa=new iy("",oO.getInstance(),c);this.Ga(this.Aa);this.F=new iW(c);this.F.He("Enable schedule");this.Ga(this.F);this.eb=3;this.C=null;this.Ia=new eNe(500,500,"dbxScheduleOnCompleteAuth");this.va(this.Ia);this.ea=b;this.L=new JNe(c);this.L.Jc("waffle-dataconnector-refresh-schedules-info-icon");this.L.setVisible(!1);this.Oa=new XY(!0);this.Fa=!1}u(F8f,Q);p=F8f.prototype;
p.Ba=function(){Q.prototype.Ba.call(this);this.ib(vx(B8f));var a=this.L.C;a.setContent(me("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."));this.L.render(this.Ea("waffle-dataconnector-refresh-schedules-header-title"));a=a.Gb();tw(this.L.Ka(),"labelledby",a.id)};
p.Ha=function(){Q.prototype.Ha.call(this);this.O.render(this.Ea("waffle-dataconnector-refresh-schedules-cancel-btn"));this.V.render(this.Ea("waffle-dataconnector-refresh-schedules-edit-btn"));this.F.render(this.Ea("waffle-dataconnector-refresh-schedules-enable-switch"));this.H.render(this.Ea("waffle-dataconnector-refresh-schedules-frequency-select"));this.R.render(this.Ea("waffle-dataconnector-refresh-schedules-save-btn"));this.Ca.render(this.Ea("waffle-dataconnector-refresh-schedules-setup-btn"));
this.Aa.render(this.Ea("waffle-dataconnector-refresh-schedules-timezone-setting-btn"));this.J.render(this.Ea("waffle-dataconnector-refresh-schedules-time-select"));this.D.render(this.Ea("waffle-dataconnector-refresh-schedules-date-select"));this.Oa.render(this.Ea("waffle-dataconnector-refresh-schedules-spinner"));H8f(this,!1);zy(this.J,new qw(null,13));this.getHandler().listen(this.V,"action",this.VSb).listen(this.O,"action",this.xSb).listen(this.R,"action",this.jUb).listen(this.Ca,"action",this.nUb).listen(this.F,
"action",this.WSb).listen(this.H,"change",this.gTb).listen(this.D,"change",this.t2).listen(this.J,"change",this.t2).listen(this.Aa,"action",this.FUb);0<Array.from(this.La.C.keys()).length?(P(this.Ka(),!0),I8f(this)):P(this.Ka(),!1)};
function J8f(a){if(!a.isDisposed()){var b=a.Ea("waffle-dataconnector-refresh-schedules-edit-section"),c=a.Ea("waffle-dataconnector-refresh-schedules-overview-section"),d=a.Ea("waffle-dataconnector-refresh-schedules-fullview-section"),e=a.Ea("waffle-dataconnector-refresh-schedules-owner-info"),f=a.Ea("waffle-dataconnector-refresh-schedules-setup-btn"),h=a.Ea("waffle-dataconnector-refresh-schedules-enable-switch"),k=a.Ea("waffle-dataconnector-refresh-schedules-spinner");P(f,!1);P(h,!1);P(b,!1);P(c,
!1);P(d,!1);P(e,!1);P(k,!1);Ew(a.Ka(),"waffle-dataconnector-refresh-schedules-widget-opened",!1);var l=!1;a.L.setVisible(!1);switch(a.eb){case 1:P(f,!0);break;case 2:P(d,!0);P(b,!0);P(e,!0);Ew(a.Ka(),"waffle-dataconnector-refresh-schedules-widget-opened",!0);l=!0;K8f(a);L8f(a);a.t2();a.O.Na(!0);a.L.setVisible(!0);break;case 3:P(k,!0);break;case 5:P(d,!0);P(h,!0);P(b,!0);P(e,!0);Ew(a.Ka(),"waffle-dataconnector-refresh-schedules-widget-opened",!0);l=!0;M8f(a);K8f(a);L8f(a);b=E(a.C,2);a.F.Vb(!!E(b,1));
c=b.Wn().Wn();a.H.setValue(c);switch(c){case 1:H8f(a,!1);break;case 2:A8f(a.D,Of(b.Wn(),4));H8f(a,!0);break;case 3:A8f(a.D,Of(b.Wn(),5)),H8f(a,!0)}a.J.setValue(E(b.Wn(),2));a.t2();a.O.Na(!0);a.L.setVisible(!0);break;case 4:P(h,!0),P(c,!0),M8f(a),c=a.Ea("waffle-dataconnector-refresh-schedules-overview-text"),N8f(a)?(b=a.C.getStatus(),Ln(c,"Next: "),c=new Date(1E3*E(b,2)),b=new Date(1E3*E(b,3)),a.V.setContent($n(a.qa(),O8f(c,b,a.ea,!0)))):(Ln(c,"Paused"),a.V.setContent("Edit"))}a.Fa!=l&&(a.Fa=l,a.dispatchEvent(l?
"di":"ci"))}}function M8f(a){var b=!!E(E(a.C,2),1);a.F.Vb(b);a.F.Na(!0)}function K8f(a){var b=a.Ea("waffle-dataconnector-refresh-schedules-owner-info"),c="Will run as you.";a.C&&(a=E(E(a.C,4),1))&&(c+=" Currently running as "+a);Ln(b,c)}
function L8f(a){var b=a.Ea("waffle-dataconnector-refresh-schedules-fullview-text");if(N8f(a)){var c=a.C.getStatus(),d=new Date(1E3*E(c,2));c=new Date(1E3*E(c,3));var e=a.qa();e.Zc(b);e.appendChild(b,$n(e,qe(me("Next: "),O8f(d,c,a.ea,!1))))}else Ln(b,"");a.Aa.setContent(P8f(a.ea))}function N8f(a){return a.C&&E(E(a.C,2),1)?(E(a.C.getStatus(),1),!0):!1}p.xSb=function(){this.eb=2==this.eb?1:4;J8f(this);this.Ea("waffle-dataconnector-refresh-schedules-title").focus()};p.VSb=function(){this.eb=5;J8f(this)};
p.gTb=function(){var a=this.H.getValue();A8f(this.D,[]);switch(a){case 1:H8f(this,!1);break;case 2:H8f(this,!0);a=this.D.Ce(Q8f());of(a);break;case 3:H8f(this,!0),a=this.D.Ce(R8f()),of(a)}this.t2()};
p.jUb=function(){this.R.Na(!1);this.O.Na(!1);var a=this.H.getValue(),b=new HL,c=new JL;c.eC(a);if(2===a){var d=ja(this.D.Dd());for(a=d.next();!a.done;a=d.next())Mf(c,4,a.value)}else if(3===a)for(d=ja(this.D.Dd()),a=d.next();!a.done;a=d.next())Mf(c,5,a.value);a=this.J.getValue();F(c,2,a);b.eC(c);F(b,3,1);2==this.eb?(b.Na(!0),S8f(this,b,null)):(b.Na(this.F.isChecked()),T8f(this,b,null))};p.nUb=function(){this.eb=2;J8f(this)};
p.WSb=function(){var a=this;if(4==this.eb){var b=E(this.C,2),c=this.F.isChecked();this.F.Vb(!c);this.F.Na(!1);if(c){var d=U8f(this);d.render();d.setVisible(!0);d.getResult().then(function(){of(d);b.Na(c);T8f(a,b,null)},function(){of(d)})}else b.Na(c),T8f(this,b,null)}};p.FUb=function(){gE.Eb()};p.t2=function(){var a=!!this.H.Ue(),b=1===this.H.getValue()||0<this.D.Dd().length,c=!!this.J.Ue();this.R.Na(a&&b&&c)};
function S8f(a,b,c,d){d=void 0===d?!0:d;var e=new L7b;F(e,1,b);c&&F(e,2,c);J7f(e).then(function(f){return V8f(a,b,f.getStatus(),E(f,2),!0,d)},function(){W8f(a)})}function T8f(a,b,c,d){d=void 0===d?!0:d;var e=new P7b;H7f(e,a.C.getId());F(e,2,b);c&&F(e,3,c);K7f(e).then(function(f){return V8f(a,b,f.getStatus(),E(f,2),!1,d)},function(){W8f(a)})}
function V8f(a,b,c,d,e,f){a.F.Na(!0);switch(c){case 1:a.Ea("waffle-dataconnector-refresh-schedules-title").focus();I8f(a);break;case 2:if(!f)break;fNe(a.Ia,d,function(h){a.isDisposed()||(a.F.Na(!1),e?S8f(a,b,h,!1):T8f(a,b,h,!1))});break;default:W8f(a)}}function I8f(a){a.eb=3;J8f(a);I7f().then(function(b){a.isDisposed()||(b=Of(b,1),0==b.length?(a.eb=1,a.C=null):(a.eb=4,a.C=b[0]),J8f(a))},function(){Az.getInstance().postMessage(Cz("Error loading schedule configuration.","error",!0))})}
function H8f(a,b){P(a.Ea("waffle-dataconnector-refresh-schedules-edit-section-row-date"),b)}
function U8f(a){var b=new cOe;b.Jc("waffle-dataconnector-refresh-schedules-resume-prompt");b.setTitle("Resume scheduled refresh?");b.C.setContent("Resume");b.H.setContent("Cancel");var c=E(a.C,2);switch(c.Wn().Wn()){case 1:var d="Daily ";break;case 2:d=X8f();var e=Of(c.Wn(),4);d="Weekly on "+(d.filter(function(l){return e.includes(l.value)}).map(function(l){return l.label}).join(", ")+" ");break;case 3:d="Monthly on the "+(Of(c.Wn(),5).map(function(l){return E8f.format({DAY:l})}).join(", ")+" ")}var f=
a.C.getStatus();c=Y8f(a.ea);var h=new Date(Ga()),k=new Date(1E3*E(f,2));f=new Date(1E3*E(f,3));d+=G8f(k,f,c)+" ("+Chb(c.C-fB(c,h))+")";a="Will run as "+E(E(a.C,4),1);a=qe(me("All connected sheets & valid related objects in this document (pivot tables, charts, extracts and functions) will be refreshed."),oe("H4",void 0,"Schedule"),me(d),oe("BR"),me(a));Pw(b,a);return b}function W8f(a){Az.getInstance().postMessage(Cz("Error saving schedule.","error",!0));a.R.Na(!0);a.O.Na(!0);a.F.Na(!0)}
function X8f(){var a=(aB.FIRSTDAYOFWEEK+1)%7,b=aB.WEEKDAYS.map(function(c,d){return{label:c,value:(d+6)%7+1}});return b.slice(a).concat(b.slice(0,a))}function Q8f(){var a=new ry,b=X8f();b=ja(b);for(var c=b.next();!c.done;c=b.next())c=c.value,a.Ga(new my(c.label,c.value),!0);return a}function R8f(){for(var a=new ry,b=1;28>=b;b++)a.Ga(new my(E8f.format({DAY:b}),b),!0);return a}function G8f(a,b,c){return C8f.format(a,c)+" - "+C8f.format(b,c)}
function O8f(a,b,c,d){var e=new mB,f=Y8f(c);f=D8f.format(a,f)+" \u00b7 "+G8f(a,b,f);a.getDate()!==b.getDate()&&(f+=e.cd("sup")+"+1"+e.ad("sup"));d&&(f+=" ("+P8f(c)+")");return e.format(f)}function P8f(a){var b=new Date(Ga());a=Y8f(a);return Chb(a.C-fB(a,b))}function Y8f(a){a=-1*a.getTimezoneOffset(new Date(Ga()));return eB(a/6E4)};function Z8f(a,b,c){gZ.call(this,c);this.O=b;this.J=b.R;this.L=a;this.Lx=new o8f(b,this.qa());this.Ga(this.Lx);this.D=new S7f(this.J,c);this.va(this.D);this.F=null;this.EF=new $8f(this.qa());this.Ga(this.EF);this.H=null}u(Z8f,gZ);p=Z8f.prototype;p.Ba=function(){gZ.prototype.Ba.call(this);this.ib(vx(T7f,{id:this.getId(),Sd:!0}));this.D.render(this.Ea("waffle-dataconnector-refresh-sidepane-footer-wrapper"))};
p.Ha=function(){var a=this;gZ.prototype.Ha.call(this);A(z(),"fedsr")&&(a9f(this),this.getHandler().listen(this,["ci","di"],this.avb));this.EF.render(this.Ka());P(this.EF.Ka(),!1);this.getHandler().listen(this.EF,"action",this.Qtb);this.Lx.render(this.Ea("waffle-dataconnector-refresh-sidepane-refresh-widget"));this.getHandler().listen(this.D,"refresh-db-object-request",function(){var b=N7f(a.J);jnb.Eb(b)});this.D.refresh();P(this.Ea("waffle-dataconnector-refresh-sidepane-backdrop"),!1)};
function b9f(a){of(a.Lx);a.Lx=new o8f(a.O,a.qa());a.Ga(a.Lx);a.Lx.render(a.Ea("waffle-dataconnector-refresh-sidepane-refresh-widget"));a.D.refresh()}function c9f(a){null!=a.F&&(of(a.F),of(a.H),a9f(a))}function d9f(a){P(a.Ea("waffle-dataconnector-refresh-sidepane-backdrop"),!0);P(a.EF.Ka(),!0);setTimeout(function(){if(a.EF.Db()){var b=a.EF.Ka();a.H=new HA(b,a.qa());a.va(a.H);IA(a.H);b.focus()}},500)}
function e9f(a,b){t8f(a.Lx,b);var c=0;b.forEach(function(d){return c+=parseInt(E(d,2),10)});a.D.Tu(c)}p.avb=function(a){var b=this;a="di"===a.type;P(this.Ea("waffle-dataconnector-refresh-sidepane-backdrop"),a);ov(this.Ea("waffle-sidebar-content"),"overflow-y",a?"hidden":"auto");of(this.H);a?setTimeout(function(){if(b.F.Db()){var c=b.F.Ka();b.H=new HA(c,b.qa());b.va(b.H);IA(b.H);c.focus()}},500):this.resize()};
function a9f(a){a.F=new F8f(a.J,a.L,a.qa());a.Ga(a.F);a.F.render(a.Ka());P(a.Ea("waffle-dataconnector-refresh-sidepane-backdrop"),!1)}p.Qtb=function(){P(this.EF.Ka(),!1);P(this.Ea("waffle-dataconnector-refresh-sidepane-backdrop"),!1);var a=this.Lx,b=a.D.Zc(!0);pf(b);p8f(a)};p.resize=function(){if(this.F&&!this.F.Fa){var a=Gv(this.Ea("waffle-sidebar-content")).height-Gv(this.F.Ka()).height,b=this.Ea("waffle-dataconnector-refresh-sidepane-refresh-widget");Fv(b,a)}};
function $8f(a){Q.call(this,a);this.C=new PA("OK",this.qa());this.Ga(this.C)}u($8f,Q);$8f.prototype.Ba=function(){Q.prototype.Ba.call(this);this.ib(vx(U7f));this.C.render(this.Ea("waffle-dataconnector-refresh-sidepane-stale-widget-button-wrapper"))};function f9f(a,b,c){vY.call(this,a,b);var d=this;this.C=c;this.D=new Em;this.va(this.D);Km(this.D,this.C.D,function(e){"dbobjectmodel-event-add"==e.getType()||"dbobjectmodel-event-remove"==e.getType()?(d9f(d.ye),e=d.ye,e.Lx.Na(!1),e.D.C.Na(!1)):(g9f(d),w8f(d.ye.Lx),d.ye.Ka().focus())});this.Ma.listen(FK,"show-db-objects-refresh-sidepane",this.F)}u(f9f,vY);f9f.prototype.Hf=function(){return lnb};f9f.prototype.Lo=function(){return mnb};
function g9f(a){var b=N7f(a.C),c=a.ye;0==b.length?Q7f(c.D):(u8f(c.Lx),hMe(c.D),P7f(a.C,b,function(d){a.isDisposed()||c.isDisposed()||e9f(c,d)},function(d){if(!a.isDisposed()&&!c.isDisposed()){d=new f8b(d[0].Jy(),d[0].Rh());v8f(c.Lx);var e=c.D;e.Db()&&(e=e.H,e.F=d,dMe(e),P(e.Ea("waffle-dbobject-estimated-bytes-error"),!0),e.C.setActive(!1))}}))}f9f.prototype.F=function(){var a=this;b9f(this.ye);P(this.ye.EF.Ka(),!1);c9f(this.ye);g9f(this);wY(this);qAa(function(){return a.ye.Ka().focus()})};function h9f(){zK.apply(this,arguments)}u(h9f,zK);h9f.prototype.C=function(){return f9f};h9f.prototype.D=function(){return Z8f};DK("dbrefresh",h9f);
